<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Treemap Grid Layout Verification</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .status {
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            background: #2a2a2a;
        }
        .success { background: #1e4620; }
        .error { background: #4a1e1e; }
        .warning { background: #4a3e1e; }
        iframe {
            width: 100%;
            height: 800px;
            border: 2px solid #444;
            border-radius: 10px;
            background: white;
        }
        pre {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Treemap Grid Layout ê²€ì¦</h1>
        
        <div class="status">
            <h2>ìƒˆë¡œìš´ ì ‘ê·¼ ë°©ì‹</h2>
            <pre>
âœ… ì™„ì „íˆ ë‹¤ë¥¸ ì ‘ê·¼: ê°ì²´ ìˆ˜ì • ì—†ëŠ” ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ
âœ… ìœ„ì¹˜ ì •ë³´ë¥¼ ë³„ë„ ë°°ì—´ë¡œ ê´€ë¦¬
âœ… readonly property ë¬¸ì œ ì™„ì „ íšŒí”¼
âœ… ë‹¨ìˆœí•œ ê·¸ë¦¬ë“œ ê¸°ë°˜ ë°°ì¹˜ë¡œ ë³µì¡ì„± ì œê±°
            </pre>
        </div>
        
        <div class="status">
            <h2>êµ¬í˜„ ë‚´ìš©</h2>
            <pre>
function calculatePositions(items, x, y, width, height) {
    // ìœ„ì¹˜ ì •ë³´ë§Œ ë³„ë„ë¡œ ê´€ë¦¬ (ê°ì²´ ìˆ˜ì • ì—†ìŒ)
    const positions = [];
    
    // ë‹¨ìˆœ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ
    const cols = Math.ceil(Math.sqrt(items.length));
    const rows = Math.ceil(items.length / cols);
    
    items.forEach((item, index) => {
        const col = index % cols;
        const row = Math.floor(index / cols);
        
        positions.push({
            x: x + col * cellWidth,
            y: y + row * cellHeight,
            width: cellWidth * 0.9,
            height: cellHeight * 0.9
        });
    });
    
    return positions;
}
            </pre>
        </div>
        
        <div class="status" id="test-results">
            <h2>ê²€ì¦ ì¤‘...</h2>
        </div>
        
        <div class="status">
            <h2>ëŒ€ì‹œë³´ë“œ</h2>
            <iframe src="output_files/management_dashboard_2025_08.html" id="dashboard"></iframe>
        </div>
    </div>
    
    <script>
        window.addEventListener('load', function() {
            const iframe = document.getElementById('dashboard');
            const results = document.getElementById('test-results');
            
            iframe.onload = function() {
                try {
                    const doc = iframe.contentDocument;
                    const win = iframe.contentWindow;
                    
                    // ì½˜ì†” ì—ëŸ¬ ì²´í¬
                    const originalError = win.console.error;
                    let errors = [];
                    win.console.error = function(...args) {
                        errors.push(args.join(' '));
                        originalError.apply(win.console, args);
                    };
                    
                    // íŠ¸ë¦¬ë§µ ì»¨í…Œì´ë„ˆ í™•ì¸
                    const treemaps = doc.querySelectorAll('[id^="treemap-"]');
                    const hasTreemaps = treemaps.length > 0;
                    
                    // íŠ¸ë¦¬ë§µ ë°•ìŠ¤ í™•ì¸
                    let boxCount = 0;
                    treemaps.forEach(tm => {
                        boxCount += tm.querySelectorAll('div[style*="position: absolute"]').length;
                    });
                    
                    // ê²°ê³¼ í‘œì‹œ
                    let html = '<h2>ê²€ì¦ ê²°ê³¼</h2><ul>';
                    
                    if (hasTreemaps) {
                        html += '<li>âœ… íŠ¸ë¦¬ë§µ ì»¨í…Œì´ë„ˆ ë°œê²¬: ' + treemaps.length + 'ê°œ</li>';
                    } else {
                        html += '<li>âŒ íŠ¸ë¦¬ë§µ ì»¨í…Œì´ë„ˆ ì—†ìŒ</li>';
                    }
                    
                    if (boxCount > 0) {
                        html += '<li>âœ… íŠ¸ë¦¬ë§µ ë°•ìŠ¤ ë Œë”ë§ë¨: ' + boxCount + 'ê°œ íŒ€</li>';
                        results.className = 'status success';
                    } else {
                        html += '<li>âŒ íŠ¸ë¦¬ë§µ ë°•ìŠ¤ê°€ ë Œë”ë§ë˜ì§€ ì•ŠìŒ</li>';
                        results.className = 'status error';
                    }
                    
                    if (errors.length === 0) {
                        html += '<li>âœ… ì½˜ì†” ì—ëŸ¬ ì—†ìŒ</li>';
                    } else {
                        html += '<li>âŒ ì½˜ì†” ì—ëŸ¬: ' + errors[0] + '</li>';
                    }
                    
                    html += '</ul>';
                    
                    // readonly ì—ëŸ¬ ì²´í¬
                    const hasReadonlyError = errors.some(e => e.includes('readonly'));
                    if (hasReadonlyError) {
                        html += '<p style="color: #ff6b6b;">âš ï¸ Readonly ì—ëŸ¬ê°€ ì—¬ì „íˆ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤!</p>';
                    } else if (boxCount > 0) {
                        html += '<p style="color: #51cf66;">ğŸ‰ Readonly ë¬¸ì œê°€ í•´ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!</p>';
                    }
                    
                    results.innerHTML = html;
                    
                } catch (e) {
                    results.innerHTML = '<h2>ê²€ì¦ ì‹¤íŒ¨</h2><p>' + e.message + '</p>';
                    results.className = 'status error';
                }
            };
        });
    </script>
</body>
</html>