# Phase 1 + 2 + 3 종합 검증 가이드

## 대시보드 열기

**파일**: `output_files/Incentive_Dashboard_2025_09_Version_6.html`
**버전**: v7.02
**날짜**: 2025-09-30

브라우저에서 파일을 열고 **Org Chart 탭**을 클릭하세요.

---

## Phase 1 검증: 번역 키 통일 & 테이블 시각적 구분

### 1️⃣ LINE LEADER 테스트 (622020174 - NGUYỄN NGỌC BÍCH THỦY)

**클릭 방법**: Org Chart에서 "NGUYỄN NGỌC BÍCH THỦY" 노드 클릭

#### ✅ 확인 사항:

**Phase 1 - 번역 키**:
- [ ] **"예상 인센티브"** 레이블 표시 (orgChart.modal.labels.expectedIncentive)
- [ ] **"실제 인센티브"** 레이블 표시 (orgChart.modal.labels.actualIncentive)
- [ ] 파란색 행: 예상 인센티브 값
- [ ] 초록/노란색 행: 실제 인센티브 값

**Phase 1 - 테이블 스타일**:
- [ ] ASSEMBLY INSPECTOR 테이블: **단순 테이블** (그룹 없음)
- [ ] 배경색 교대 **없음** (LINE LEADER는 useAlternatingColors: false)

---

### 2️⃣ GROUP LEADER 테스트 (622020118 - LƯƠNG THỊ CẨM TIÊN)

**클릭 방법**: Org Chart에서 "LƯƠNG THỊ CẨM TIÊN" 노드 클릭

#### ✅ 확인 사항:

**Phase 1 - 번역 키**:
- [ ] "예상 인센티브" / "실제 인센티브" 레이블 표시

**Phase 1 - 테이블 스타일**:
- [ ] LINE LEADER 테이블: **단순 테이블** (그룹 없음)
- [ ] 배경색 교대 **없음**

---

### 3️⃣ SUPERVISOR 테스트 (822000065 - NGUYỄN THỊ HỒNG NHUNG)

**클릭 방법**: Org Chart에서 "NGUYỄN THỊ HỒNG NHUNG" 노드 클릭

#### ✅ 확인 사항:

**Phase 1 - 번역 키**:
- [ ] "예상 인센티브" / "실제 인센티브" 레이블 표시

**Phase 1 - 테이블 스타일 (핵심!)**:
- [ ] LINE LEADER 테이블: **GROUP별 그룹화** (첫 번째 컬럼에 GROUP LEADER 이름)
- [ ] **배경색 교대 있음**: 첫 번째 그룹 흰색, 두 번째 그룹 회색(`table-light`), 세 번째 그룹 흰색...
- [ ] 각 그룹의 LINE LEADER들이 rowspan으로 묶여있음

**예시**:
```
┌──────────────┬─────────────┬────────┬────────────┬────────┐
│ GROUP LEADER │ LINE LEADER │   ID   │ Incentive  │ Status │
├──────────────┼─────────────┼────────┼────────────┼────────┤
│              │ Leader 1    │ 123456 │ 50,000 VND │   ✅   │  ← 흰색 배경
│ Group A      │ Leader 2    │ 234567 │ 60,000 VND │   ✅   │  ← 흰색 배경
│              │ Leader 3    │ 345678 │      -     │   ❌   │  ← 흰색 배경
├──────────────┼─────────────┼────────┼────────────┼────────┤
│              │ Leader 4    │ 456789 │ 55,000 VND │   ✅   │  ← 회색 배경
│ Group B      │ Leader 5    │ 567890 │ 70,000 VND │   ✅   │  ← 회색 배경
└──────────────┴─────────────┴────────┴────────────┴────────┘
```

---

### 4️⃣ A.MANAGER 테스트 (821000029 - CHÂU THỊ KIỀU DIỄM)

**클릭 방법**: Org Chart에서 "CHÂU THỊ KIỀU DIỄM" 노드 클릭

#### ✅ 확인 사항:

**Phase 1 - 번역 키**:
- [ ] "예상 인센티브" / "실제 인센티브" 레이블 표시

**Phase 1 - 테이블 스타일**:
- [ ] LINE LEADER 테이블: **GROUP별 그룹화**
- [ ] 배경색 교대 **없음** (A.MANAGER는 useAlternatingColors: false)
- [ ] 모든 행이 동일한 흰색 배경

---

### 5️⃣ MANAGER 테스트 (621000009 - HUỲNH THỊ BÍCH NGỌC)

**클릭 방법**: Org Chart에서 "HUỲNH THỊ BÍCH NGỌC" 노드 클릭

#### ✅ 확인 사항:

**Phase 1 - 번역 키**:
- [ ] "예상 인센티브" / "실제 인센티브" 레이블 표시

**Phase 1 - 테이블 스타일**:
- [ ] LINE LEADER 테이블: **GROUP별 그룹화**
- [ ] **배경색 교대 있음** (SUPERVISOR와 동일)

---

## Phase 2 검증: 알림 박스

### 🔴 빨간색 위험 알림 (인센티브 = 0인 직원)

**테스트 대상**: 인센티브를 받지 못한 직원 찾기

#### ✅ 확인 사항:

- [ ] **빨간색 배경** (`alert-danger`)
- [ ] 제목: "미지급 사유" (🚨 아이콘 포함)
- [ ] 미지급 사유 목록:
  - 실제 근무일 0일 (출근 조건 1번 미충족)
  - 무단결근 2일 초과 (출근 조건 2번 미충족)
  - 결근율 12% 초과 (출근 조건 3번 미충족)
  - 최소 근무일 미달 (출근 조건 4번 미충족)
  - 팀/구역 AQL 실패 (AQL 조건 7번 미충족)
  - 9월 AQL 실패 X건
  - 3개월 연속 AQL 실패
  - 2개월 연속 AQL 실패
  - 5PRS 검증 부족 또는 합격률 95% 미달
  - 5PRS 총 검증 수량 0

**예시 화면**:
```
┌───────────────────────────────────────────────┐
│ 🚨 미지급 사유                                │
│                                               │
│ • 실제 근무일 0일 (출근 조건 1번 미충족)      │
│ • 9월 AQL 실패 2건                            │
└───────────────────────────────────────────────┘
```

---

### ⚠️ 노란색 차이 알림 (예상 ≠ 실제, 차이 ≥ 1,000 VND)

**테스트 대상**: 부하 직원 중 일부가 조건 미충족으로 인센티브를 못 받은 관리자

#### ✅ 확인 사항:

- [ ] **노란색 배경** (`alert-warning`)
- [ ] 제목: "인센티브 차이 안내" (ℹ️ 아이콘 포함)
- [ ] 테이블 표시:
  ```
  예상 인센티브:  ₫150,000
  실제 인센티브:  ₫120,000
  ───────────────────────────
  차이:           ₫30,000
  ```
- [ ] 설명 문구: "💡 차이 원인: 부하 직원 중 일부가 조건 미충족으로 인센티브를 받지 못했습니다."

**예시 화면**:
```
┌───────────────────────────────────────────────┐
│ ℹ️  인센티브 차이 안내                        │
│                                               │
│ 예상 인센티브:  ₫150,000                      │
│ 실제 인센티브:  ₫120,000                      │
│ ─────────────────────────────                 │
│ 차이:           ₫30,000                        │
│                                               │
│ 💡 차이 원인: 부하 직원 중 일부가 조건        │
│    미충족으로 인센티브를 받지 못했습니다.     │
└───────────────────────────────────────────────┘
```

---

## Phase 3 검증: 코드 리팩토링 (기능 테스트)

Phase 3는 코드 구조 개선이므로, **모든 기능이 Phase 1 & 2와 동일**해야 합니다.

### ✅ 전체 기능 작동 확인:

**5개 직급 모두 테스트**:
- [ ] LINE LEADER: 계산 공식, ASSEMBLY INSPECTOR 테이블, 예상/실제 비교
- [ ] GROUP LEADER: 계산 공식, LINE LEADER 테이블, 평균 계산
- [ ] SUPERVISOR: 계산 공식, 그룹화된 테이블, 배경색 교대
- [ ] A.MANAGER: 계산 공식, 그룹화된 테이블 (배경색 교대 없음)
- [ ] MANAGER: 계산 공식, 그룹화된 테이블, 배경색 교대

**알림 박스**:
- [ ] 빨간색 위험 알림 (인센티브 = 0)
- [ ] 노란색 차이 알림 (예상 ≠ 실제)

**계산 정확도**:
- [ ] LINE LEADER: `부하 인센티브 합 × 12% × 수령비율`
- [ ] GROUP LEADER: `LINE LEADER 평균 × 2`
- [ ] SUPERVISOR: `LINE LEADER 평균 × 2.5`
- [ ] A.MANAGER: `LINE LEADER 평균 × 3`
- [ ] MANAGER: `LINE LEADER 평균 × 3.5`

---

## 언어 전환 테스트

**버튼**: 우측 상단의 "Language: 한국어" 버튼 클릭

### ✅ 한국어 → 영어:

- [ ] "예상 인센티브" → "Expected Incentive"
- [ ] "실제 인센티브" → "Actual Incentive"
- [ ] "미지급 사유" → "Non-Payment Reason"
- [ ] "인센티브 차이 안내" → "Incentive Difference Notice"

### ✅ 한국어 → 베트남어:

- [ ] "예상 인센티브" → "Khuyến khích dự kiến"
- [ ] "실제 인센티브" → "Khuyến khích thực tế"
- [ ] "미지급 사유" → "Lý do không thanh toán"
- [ ] "인센티브 차이 안내" → "Thông báo sự khác biệt khuyến khích"

---

## 최종 검증 체크리스트

### Phase 1 (번역 & 테이블)
- [ ] 모든 직급에서 "예상 인센티브" / "실제 인센티브" 표시
- [ ] SUPERVISOR & MANAGER: 그룹화된 테이블 + 배경색 교대
- [ ] A.MANAGER: 그룹화된 테이블 (배경색 교대 없음)
- [ ] LINE LEADER & GROUP LEADER: 단순 테이블

### Phase 2 (알림 박스)
- [ ] 빨간색 위험 알림: 인센티브 = 0인 직원
- [ ] 노란색 차이 알림: |예상 - 실제| ≥ 1,000 VND
- [ ] 알림 박스 내 테이블: 예상/실제/차이 표시
- [ ] 설명 문구: 차이 원인 안내

### Phase 3 (리팩토링)
- [ ] 모든 기능이 Phase 1 & 2와 동일하게 작동
- [ ] 5개 직급 모두 계산 정확
- [ ] 번역 정상 작동 (한국어/영어/베트남어)
- [ ] 대시보드 로딩 오류 없음

---

## 성공 기준

✅ **Phase 1+2+3 모두 성공**:
- 5개 직급 × 3개 언어 = 15개 조합 모두 정상 작동
- 알림 박스 정상 표시 (빨간색 & 노란색)
- 테이블 스타일 정확 (그룹화, 배경색 교대)
- 계산 공식 정확

✅ **대시보드 정보**:
- 버전: v7.02
- 전체 직원: 417명
- 지급 대상: 288명
- 총 지급액: 123,621,132 VND

---

## 문제 발생 시

1. **번역 키가 표시되지 않을 때**:
   - 브라우저 콘솔(F12) 확인
   - `dashboard_translations.json` 파일 확인

2. **테이블 스타일이 다를 때**:
   - POSITION_CONFIG의 useGrouping, useAlternatingColors 설정 확인
   - CSS 클래스 `table-light` 적용 여부 확인

3. **알림 박스가 표시되지 않을 때**:
   - expectedIncentive 계산 확인
   - employeeIncentive 값 확인
   - 조건: incentive = 0 또는 |expected - actual| ≥ 1,000

4. **계산이 틀릴 때**:
   - `calculateExpectedIncentive()` 함수 확인
   - POSITION_CONFIG의 multiplier 값 확인
   - subordinates 필터링 로직 확인