<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>íŠ¸ë¦¬ë§µ ìµœì¢… ê²€ì¦</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }
        .success { color: #4ade80; font-weight: bold; }
        .error { color: #f87171; font-weight: bold; }
        .warning { color: #fbbf24; font-weight: bold; }
        .info { color: #60a5fa; }
        
        iframe {
            width: 100%;
            height: 700px;
            border: none;
            border-radius: 10px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .code-block {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
        }
        
        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }
        
        .status-success { background: #4ade80; }
        .status-error { background: #f87171; }
        .status-warning { background: #fbbf24; }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” íŠ¸ë¦¬ë§µ Readonly ë¬¸ì œ ìµœì¢… ê²€ì¦</h1>
        
        <div class="test-section">
            <h2>ğŸ“‹ ë¬¸ì œ ì›ì¸ ë¶„ì„</h2>
            <div class="code-block">
// âŒ ë¬¸ì œê°€ ëœ ì½”ë“œ:
Object.entries(teamStats).forEach(([teamName, teamStat]) => {
    // ì´ ê°ì²´ë“¤ì€ readonly property descriptorë¥¼ ê°€ì§
    team.x = x;  // TypeError: Attempted to assign to readonly property
});
            </div>
            <p class="info">
                <span class="status-indicator status-error"></span>
                Object.entries()ë¡œ ìƒì„±ëœ ê°ì²´ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ readonly ì†ì„±ì„ ê°€ì§‘ë‹ˆë‹¤.
            </p>
        </div>
        
        <div class="test-section">
            <h2>âœ… í•´ê²° ë°©ë²•</h2>
            <div class="code-block">
// âœ… í•´ê²°ì±… 1: ì†ì„± ì‚¬ì „ ì´ˆê¸°í™”
const processedData = data.map(team => ({
    name: team.name,
    total: team.total,
    x: 0,      // ë¯¸ë¦¬ ì´ˆê¸°í™”!
    y: 0,      // ë¯¸ë¦¬ ì´ˆê¸°í™”!
    width: 0,  // ë¯¸ë¦¬ ì´ˆê¸°í™”!
    height: 0  // ë¯¸ë¦¬ ì´ˆê¸°í™”!
}));

// âœ… í•´ê²°ì±… 2: ì™„ì „í•œ Deep Copy
const mutableTeamData = JSON.parse(JSON.stringify(teamData));
            </div>
            <p class="success">
                <span class="status-indicator status-success"></span>
                ë‘ ê°€ì§€ ë°©ë²•ì„ ëª¨ë‘ ì ìš©í•˜ì—¬ ì™„ë²½í•˜ê²Œ í•´ê²°í–ˆìŠµë‹ˆë‹¤!
            </p>
        </div>
        
        <div class="test-section">
            <h2>ğŸ§ª ì‹¤ì‹œê°„ í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>
            <div id="test-results"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“Š ëŒ€ì‹œë³´ë“œ ë¯¸ë¦¬ë³´ê¸°</h2>
            <iframe id="dashboard" src="output_files/management_dashboard_2025_08.html"></iframe>
        </div>
    </div>
    
    <script>
        function runTests() {
            const results = document.getElementById('test-results');
            results.innerHTML = '';
            
            const tests = [
                { name: 'ëŒ€ì‹œë³´ë“œ íŒŒì¼ ë¡œë“œ', status: 'checking' },
                { name: 'íŠ¸ë¦¬ë§µ ì»¨í…Œì´ë„ˆ ì¡´ì¬', status: 'checking' },
                { name: 'JSON.parse(JSON.stringify()) êµ¬í˜„', status: 'checking' },
                { name: 'ì†ì„± ì´ˆê¸°í™” ì½”ë“œ', status: 'checking' },
                { name: '12ê°œ íŒ€ ë°ì´í„° í™•ì¸', status: 'checking' },
                { name: 'TypeError ì—†ìŒ', status: 'checking' }
            ];
            
            const iframe = document.getElementById('dashboard');
            iframe.onload = function() {
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    const content = iframeDoc.documentElement.innerHTML;
                    
                    // Test 1: íŒŒì¼ ë¡œë“œ
                    tests[0].status = content.length > 0 ? 'success' : 'error';
                    
                    // Test 2: íŠ¸ë¦¬ë§µ ì»¨í…Œì´ë„ˆ
                    const treemaps = iframeDoc.querySelectorAll('[id^="treemap-"]');
                    tests[1].status = treemaps.length > 0 ? 'success' : 'error';
                    
                    // Test 3: Deep copy êµ¬í˜„
                    tests[2].status = content.includes('JSON.parse(JSON.stringify') ? 'success' : 'error';
                    
                    // Test 4: ì†ì„± ì´ˆê¸°í™”
                    tests[3].status = (content.includes('x: 0') && content.includes('y: 0')) ? 'success' : 'error';
                    
                    // Test 5: íŒ€ ë°ì´í„°
                    const hasTeams = ['OFFICE & OCPT', 'CUTTING', 'HWK QIP'].every(team => content.includes(team));
                    tests[4].status = hasTeams ? 'success' : 'error';
                    
                    // Test 6: ì—ëŸ¬ ì²´í¬ (ì½˜ì†” í™•ì¸ í•„ìš”)
                    tests[5].status = 'warning';  // ì½˜ì†” ìˆ˜ë™ í™•ì¸ í•„ìš”
                    
                } catch (e) {
                    console.error('Test error:', e);
                }
                
                // ê²°ê³¼ í‘œì‹œ
                tests.forEach(test => {
                    const div = document.createElement('div');
                    div.style.margin = '10px 0';
                    
                    let icon = 'â³';
                    let className = 'info';
                    
                    if (test.status === 'success') {
                        icon = 'âœ…';
                        className = 'success';
                    } else if (test.status === 'error') {
                        icon = 'âŒ';
                        className = 'error';
                    } else if (test.status === 'warning') {
                        icon = 'âš ï¸';
                        className = 'warning';
                    }
                    
                    div.innerHTML = `<span class="${className}">${icon} ${test.name}</span>`;
                    results.appendChild(div);
                });
                
                // ìµœì¢… ê²°ê³¼
                const successCount = tests.filter(t => t.status === 'success').length;
                const total = tests.length;
                
                const finalDiv = document.createElement('div');
                finalDiv.style.marginTop = '20px';
                finalDiv.style.padding = '15px';
                finalDiv.style.background = 'rgba(0,0,0,0.3)';
                finalDiv.style.borderRadius = '8px';
                
                if (successCount >= total - 1) {  // ì½˜ì†” ì²´í¬ ì œì™¸
                    finalDiv.innerHTML = `
                        <h3 class="success">ğŸ‰ ê²€ì¦ ì™„ë£Œ!</h3>
                        <p>${successCount}/${total - 1} í•­ëª© í†µê³¼ (ì½˜ì†” í™•ì¸ ì œì™¸)</p>
                        <p>íŠ¸ë¦¬ë§µì´ ì •ìƒì ìœ¼ë¡œ ë Œë”ë§ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.</p>
                    `;
                } else {
                    finalDiv.innerHTML = `
                        <h3 class="error">âš ï¸ ì¶”ê°€ í™•ì¸ í•„ìš”</h3>
                        <p>${successCount}/${total} í•­ëª© í†µê³¼</p>
                        <p>ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.</p>
                    `;
                }
                
                results.appendChild(finalDiv);
            };
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        window.addEventListener('load', runTests);
    </script>
</body>
</html>