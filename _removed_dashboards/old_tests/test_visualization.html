<!DOCTYPE html>
<html>
<head>
    <title>Visualization Test</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <h1>Organization Chart Visualization Test</h1>

    <select id="testVisualization" onchange="testVisualization()">
        <option value="">Select visualization to test</option>
        <option value="collapsible">Test Collapsible Tree</option>
        <option value="radial">Test Radial Tree</option>
        <option value="horizontal">Test Horizontal Tree</option>
        <option value="vertical">Test Vertical Tree</option>
    </select>

    <div id="testResults"></div>

    <script>
        function testVisualization() {
            const type = document.getElementById('testVisualization').value;
            const results = document.getElementById('testResults');

            if (!type) return;

            // Test data
            const testData = [
                { id: "root", name: "Hwaseung", parentId: null, position: "ROOT" },
                { id: "1", name: "Manager 1", parentId: "root", position: "MANAGER" },
                { id: "2", name: "Supervisor 1", parentId: "1", position: "SUPERVISOR" },
                { id: "3", name: "Line Leader 1", parentId: "2", position: "LINE LEADER" },
                { id: "4", name: "Inspector 1", parentId: "3", position: "INSPECTOR" },
                { id: "5", name: "Inspector 2", parentId: "3", position: "INSPECTOR" }
            ];

            try {
                // Test D3 stratify
                const root = d3.stratify()
                    .id(d => d.id)
                    .parentId(d => d.parentId)(testData);

                results.innerHTML = `
                    <h3>Test Results for ${type}:</h3>
                    <p style="color: green;">✅ D3 stratify successful</p>
                    <p>✅ Root node: ${root.data.name}</p>
                    <p>✅ Total nodes: ${root.descendants().length}</p>
                    <p>✅ Leaf nodes: ${root.leaves().length}</p>
                    <p>✅ Tree height: ${root.height}</p>
                `;

                // Test tree layout
                if (type === 'radial') {
                    const tree = d3.tree().size([2 * Math.PI, 100]);
                    tree(root);
                    results.innerHTML += '<p>✅ Radial tree layout applied</p>';
                } else {
                    const tree = d3.tree().size([400, 300]);
                    tree(root);
                    results.innerHTML += '<p>✅ Standard tree layout applied</p>';
                }

                results.innerHTML += '<p style="color: green; font-weight: bold;">All tests passed for ' + type + ' visualization!</p>';

            } catch (error) {
                results.innerHTML = `
                    <h3>Test Failed for ${type}:</h3>
                    <p style="color: red;">❌ Error: ${error.message}</p>
                `;
            }
        }

        // Auto-test all visualizations
        window.onload = function() {
            console.log("Test page loaded successfully");
        };
    </script>
</body>
</html>