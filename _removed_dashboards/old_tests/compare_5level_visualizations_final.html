<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>5ë‹¨ê³„ ê³„ì¸µ êµ¬ì¡° ì‹œê°í™” ë¹„êµ</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        h1 {
            margin: 0;
            font-size: 32px;
        }
        .subtitle {
            margin-top: 10px;
            opacity: 0.9;
        }
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .viz-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .viz-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        .viz-description {
            color: #666;
            font-size: 14px;
            margin-bottom: 15px;
        }
        .chart-area {
            height: 600px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }
        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        .pros, .cons {
            padding: 10px;
            border-radius: 5px;
            font-size: 13px;
        }
        .pros {
            background: #e8f5e9;
            border-left: 3px solid #4caf50;
        }
        .cons {
            background: #ffebee;
            border-left: 3px solid #f44336;
        }
        .pros h4, .cons h4 {
            margin: 0 0 5px 0;
            font-size: 14px;
        }
        .pros ul, .cons ul {
            margin: 5px 0;
            padding-left: 20px;
        }
        .controls {
            margin-top: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        button {
            padding: 8px 16px;
            margin-right: 10px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background: #5a67d8;
        }
        .summary {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .summary h2 {
            color: #333;
            margin-bottom: 15px;
        }
        .data-info {
            background: #f0f4f8;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .hierarchy-level {
            display: inline-block;
            padding: 5px 10px;
            margin: 0 5px;
            background: #e3f2fd;
            border-radius: 3px;
            font-weight: 500;
        }
        
        /* Treemap specific styles */
        .treemap-container {
            position: relative;
            width: 100%;
            height: 100%;
        }
        .treemap-cell {
            position: absolute;
            border: 1px solid white;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 11px;
            color: white;
            font-weight: 500;
        }
        .treemap-cell:hover {
            transform: scale(1.02);
            z-index: 10;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        .breadcrumb {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            margin-bottom: 10px;
            font-size: 14px;
        }
        .breadcrumb span {
            cursor: pointer;
            color: #667eea;
            text-decoration: underline;
        }
        
        /* Collapsible Tree styles */
        .node circle {
            fill: #fff;
            stroke: #667eea;
            stroke-width: 3px;
            cursor: pointer;
        }
        .node text {
            font: 12px sans-serif;
        }
        .link {
            fill: none;
            stroke: #ccc;
            stroke-width: 2px;
        }
        .node.collapsed circle {
            fill: #667eea;
        }
        
        /* Loading indicator */
        .loading {
            text-align: center;
            padding: 50px;
            color: #999;
        }
        
        /* Legend */
        .legend {
            margin-top: 15px;
            padding: 10px;
            background: #fafafa;
            border-radius: 5px;
            font-size: 12px;
        }
        .legend-item {
            display: inline-block;
            margin-right: 15px;
        }
        .legend-color {
            display: inline-block;
            width: 20px;
            height: 12px;
            margin-right: 5px;
            border-radius: 2px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¯ 5ë‹¨ê³„ ê³„ì¸µ êµ¬ì¡° ì‹œê°í™” ë¹„êµ</h1>
        <div class="subtitle">Teams â†’ Role Categories â†’ Position 1st â†’ Position 2nd â†’ Position 3rd</div>
    </div>

    <div class="summary">
        <h2>ğŸ“Š ë°ì´í„° êµ¬ì¡° ìš”ì•½</h2>
        <div class="data-info">
            <p><strong>ì´ ë ˆì½”ë“œ:</strong> 70ê°œ</p>
            <p><strong>ê³„ì¸µ êµ¬ì¡°:</strong> 
                <span class="hierarchy-level">Teams (12ê°œ)</span> â†’
                <span class="hierarchy-level">Role Categories (18ê°œ)</span> â†’
                <span class="hierarchy-level">Position 1st (20ê°œ)</span> â†’
                <span class="hierarchy-level">Position 2nd (35ê°œ)</span> â†’
                <span class="hierarchy-level">Position 3rd (60ê°œ)</span>
            </p>
            <p><strong>ë°ì´í„° íŠ¹ì§•:</strong> ëª¨ë“  ë ˆì½”ë“œê°€ ì™„ì „í•œ 5ë‹¨ê³„ ê³„ì¸µ ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆìŒ</p>
        </div>
    </div>

    <div class="comparison-grid">
        <!-- 1. Sunburst Chart -->
        <div class="viz-container">
            <div class="viz-title">ğŸŒŸ 1. Sunburst Chart (ì¬ë²„ìŠ¤íŠ¸ ì°¨íŠ¸)</div>
            <div class="viz-description">ì¤‘ì‹¬ì—ì„œ ë°”ê¹¥ìœ¼ë¡œ í™•ì¥ë˜ëŠ” ì›í˜• ê³„ì¸µ êµ¬ì¡°</div>
            <div class="chart-area" id="sunburst-chart">
                <div class="loading">ì°¨íŠ¸ë¥¼ ë¡œë”© ì¤‘...</div>
            </div>
            <div class="controls">
                <button onclick="resetSunburst()">ì „ì²´ ë³´ê¸°</button>
            </div>
            <div class="pros-cons">
                <div class="pros">
                    <h4>âœ… ì¥ì </h4>
                    <ul>
                        <li>5ë‹¨ê³„ ê³„ì¸µì„ ëª…í™•í•˜ê²Œ í‘œí˜„</li>
                        <li>í´ë¦­ìœ¼ë¡œ ë“œë¦´ë‹¤ìš´ ê°€ëŠ¥</li>
                        <li>ë¹„ìœ¨ì„ ê°ë„ë¡œ ì§ê´€ì  í‘œí˜„</li>
                        <li>ì „ì²´ êµ¬ì¡° í•œëˆˆì— íŒŒì•…</li>
                    </ul>
                </div>
                <div class="cons">
                    <h4>âŒ ë‹¨ì </h4>
                    <ul>
                        <li>ì‘ì€ ì„¹ì…˜ì˜ í…ìŠ¤íŠ¸ í‘œì‹œ ì–´ë ¤ì›€</li>
                        <li>ê¹Šì€ ê³„ì¸µì¼ìˆ˜ë¡ ê³µê°„ ì¢ì•„ì§</li>
                        <li>ë§ì€ ë°ì´í„° ì‹œ ë³µì¡í•´ ë³´ì„</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 2. Zoomable Treemap -->
        <div class="viz-container">
            <div class="viz-title">ğŸ“¦ 2. Zoomable Treemap (ì¤Œ ê°€ëŠ¥í•œ íŠ¸ë¦¬ë§µ)</div>
            <div class="viz-description">í´ë¦­ìœ¼ë¡œ í™•ëŒ€/ì¶•ì†Œ ê°€ëŠ¥í•œ ê³„ì¸µì  ì‚¬ê°í˜•</div>
            <div class="breadcrumb" id="treemap-breadcrumb">
                <span onclick="navigateTreemap('root')">ì „ì²´</span>
            </div>
            <div class="chart-area" id="treemap-chart">
                <div class="treemap-container" id="treemap-container"></div>
            </div>
            <div class="controls">
                <button onclick="zoomOutTreemap()">ìƒìœ„ ë ˆë²¨ë¡œ</button>
                <button onclick="resetTreemap()">ì „ì²´ ë³´ê¸°</button>
            </div>
            <div class="pros-cons">
                <div class="pros">
                    <h4>âœ… ì¥ì </h4>
                    <ul>
                        <li>ê³µê°„ í™œìš© ë§¤ìš° íš¨ìœ¨ì </li>
                        <li>í¬ê¸°ë¡œ ì¤‘ìš”ë„ í‘œí˜„</li>
                        <li>ê¹Šì€ ê³„ì¸µ íƒìƒ‰ ìš©ì´</li>
                        <li>ë§ì€ ë°ì´í„° í‘œí˜„ ê°€ëŠ¥</li>
                    </ul>
                </div>
                <div class="cons">
                    <h4>âŒ ë‹¨ì </h4>
                    <ul>
                        <li>ì „ì²´ êµ¬ì¡° íŒŒì•… ì–´ë ¤ì›€</li>
                        <li>ê³„ì¸µ ê¹Šì´ ì¸ì§€ ì–´ë ¤ì›€</li>
                        <li>ë„¤ë¹„ê²Œì´ì…˜ ë³µì¡í•  ìˆ˜ ìˆìŒ</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 3. Hybrid Approach -->
        <div class="viz-container">
            <div class="viz-title">ğŸ”„ 3. Hybrid Approach (í•˜ì´ë¸Œë¦¬ë“œ)</div>
            <div class="viz-description">ê¸°ë³¸ íŠ¸ë¦¬ë§µ + í´ë¦­ ì‹œ ìƒì„¸ Sunburst</div>
            <div class="chart-area" id="hybrid-chart">
                <div id="hybrid-main" style="height: 50%;"></div>
                <div id="hybrid-detail" style="height: 50%; display: none;"></div>
            </div>
            <div class="controls">
                <button onclick="toggleHybridView()">ë·° ì „í™˜</button>
                <button onclick="resetHybrid()">ì´ˆê¸°í™”</button>
            </div>
            <div class="pros-cons">
                <div class="pros">
                    <h4>âœ… ì¥ì </h4>
                    <ul>
                        <li>Overview + Detail íŒ¨í„´</li>
                        <li>ë‘ ì‹œê°í™”ì˜ ì¥ì  ê²°í•©</li>
                        <li>ìœ ì—°í•œ íƒìƒ‰ ê°€ëŠ¥</li>
                        <li>ì»¨í…ìŠ¤íŠ¸ ìœ ì§€</li>
                    </ul>
                </div>
                <div class="cons">
                    <h4>âŒ ë‹¨ì </h4>
                    <ul>
                        <li>êµ¬í˜„ ë³µì¡ë„ ë†’ìŒ</li>
                        <li>í™”ë©´ ê³µê°„ ë§ì´ í•„ìš”</li>
                        <li>ì‚¬ìš©ì í•™ìŠµ í•„ìš”</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- 4. Collapsible Tree -->
        <div class="viz-container">
            <div class="viz-title">ğŸŒ³ 4. Collapsible Tree (ì ‘ì´ì‹ íŠ¸ë¦¬)</div>
            <div class="viz-description">ë…¸ë“œ í´ë¦­ìœ¼ë¡œ í™•ì¥/ì¶•ì†Œ ê°€ëŠ¥í•œ íŠ¸ë¦¬ êµ¬ì¡°</div>
            <div class="chart-area" id="tree-chart">
                <svg id="tree-svg" width="100%" height="100%"></svg>
            </div>
            <div class="controls">
                <button onclick="expandAllTree()">ëª¨ë‘ í¼ì¹˜ê¸°</button>
                <button onclick="collapseAllTree()">ëª¨ë‘ ì ‘ê¸°</button>
                <button onclick="resetTreeView()">ì´ˆê¸° ìƒíƒœ</button>
            </div>
            <div class="pros-cons">
                <div class="pros">
                    <h4>âœ… ì¥ì </h4>
                    <ul>
                        <li>ê³„ì¸µ êµ¬ì¡° ë§¤ìš° ëª…í™•</li>
                        <li>ì„ íƒì  í™•ì¥/ì¶•ì†Œ</li>
                        <li>ê²½ë¡œ ì¶”ì  ìš©ì´</li>
                        <li>ì§ê´€ì ì¸ íƒìƒ‰</li>
                    </ul>
                </div>
                <div class="cons">
                    <h4>âŒ ë‹¨ì </h4>
                    <ul>
                        <li>ë§ì€ ë…¸ë“œ ì‹œ ê³µê°„ ë¶€ì¡±</li>
                        <li>í¬ê¸° ë¹„êµ ì–´ë ¤ì›€</li>
                        <li>ì „ì²´ í¼ì¹  ì‹œ ë§¤ìš° ê¸¸ì–´ì§</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì‹¤ì œ ë°ì´í„° êµ¬ì¡° ìƒì„±
        const rawData = [
            {teams: "AQL", role_categories: "CFA", position_1st: "AQL INSPECTOR", position_2nd: "AQL INSPECTOR", position_3rd: "AQL INSPECTOR"},
            {teams: "AQL", role_categories: "PACKING", position_1st: "AQL INSPECTOR", position_2nd: "QIP PACKING TEAM", position_3rd: "FG WH INPUT-OUTPUT CARTON RQC"},
            {teams: "AQL", role_categories: "PACKING", position_1st: "AQL INSPECTOR", position_2nd: "QIP PACKING TEAM", position_3rd: "FG WH CARTON PACKING RQC"},
            {teams: "AQL", role_categories: "PACKING", position_1st: "AQL INSPECTOR", position_2nd: "QIP PACKING TEAM", position_3rd: "FG WH CARTON PACKING TQC"},
            {teams: "AQL", role_categories: "PACKING", position_1st: "AQL INSPECTOR", position_2nd: "QIP PACKING TEAM", position_3rd: "AQL INPUT CARTON TQC"},
            {teams: "AQL", role_categories: "PACKING", position_1st: "AQL INSPECTOR", position_2nd: "QIP PACKING TEAM", position_3rd: "AQL ROOM PACKING TQC"},
            {teams: "AQL", role_categories: "REPORT", position_1st: "AQL INSPECTOR", position_2nd: "REPORT TEAM", position_3rd: "AQL REPORT TEAM"},
            {teams: "AQL", role_categories: "REPORT", position_1st: "GROUP LEADER", position_2nd: "REPORT TEAM", position_3rd: "AQL REPORT TEAM"},
            {teams: "ASSEMBLY", role_categories: "TOP-MANAGEMENT", position_1st: "A.MANAGER", position_2nd: "A.MANAGER", position_3rd: "ALL ASSEMBLY BUILDING QUALITY IN CHARGE"},
            {teams: "ASSEMBLY", role_categories: "TOP-MANAGEMENT", position_1st: "(V) SUPERVISOR", position_2nd: "(V) SUPERVISOR", position_3rd: "2 ASSEMBLY BUILDING QUALITY IN CHARGE"},
            {teams: "ASSEMBLY", role_categories: "MID-MANAGEMENT", position_1st: "GROUP LEADER", position_2nd: "GROUP LEADER", position_3rd: "1 ASSEMBLY BUILDING QUALITY IN CHARGE"},
            {teams: "ASSEMBLY", role_categories: "MID-MANAGEMENT", position_1st: "LINE LEADER", position_2nd: "LINE LEADER(GROUP LEADER SUCCESSOR)", position_3rd: "12 ASSEMBLY LINE QUALITY IN CHARGE"},
            {teams: "ASSEMBLY", role_categories: "INSPECTOR", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "SHOES INSPECTOR", position_3rd: "ASSEMBLY LINE TQC"},
            {teams: "ASSEMBLY", role_categories: "INSPECTOR", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "SHOES INSPECTOR", position_3rd: "ASSEMBLY LINE RQC"},
            {teams: "ASSEMBLY", role_categories: "PO COMPLETION", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "QIP PO COMPLETION TEAM", position_3rd: "ASSEMBLY LINE PO COMPLETION QUALITY"},
            {teams: "ASSEMBLY", role_categories: "SUPPORT", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "B-GRADE TEAM / TEST SAMPLE HANDLING TEAM", position_3rd: "ASSEMBLY LINE RQC"},
            {teams: "ASSEMBLY", role_categories: "SUPPORT", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "B-GRADE TEAM / TEST SAMPLE HANDLING TEAM", position_3rd: "ALL B-GRADE CONTROL & PACKING"},
            {teams: "ASSEMBLY", role_categories: "PACKING", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "QIP PACKING TEAM", position_3rd: "SCAN PACK AREA TQC"},
            {teams: "BOTTOM", role_categories: "MID-MANAGEMENT", position_1st: "GROUP LEADER", position_2nd: "HEAD/ GROUP LEADER", position_3rd: "ALL BUILDING BOTTOM QUALITY IN CHARGE"},
            {teams: "BOTTOM", role_categories: "MID-MANAGEMENT", position_1st: "LINE LEADER", position_2nd: "LINE LEADER(GROUP LEADER SUCCESSOR)", position_3rd: "1 BUILDING BOTTOM QUALITY IN CHARGE"},
            {teams: "BOTTOM", role_categories: "INSPECTOR", position_1st: "BOTTOM INSPECTOR", position_2nd: "BOTTOM INSPECTOR", position_3rd: "BOTTOM INSPECTION RQC"},
            {teams: "BOTTOM", role_categories: "INSPECTOR", position_1st: "BOTTOM INSPECTOR", position_2nd: "BOTTOM INSPECTOR", position_3rd: "BOTTOM INSPECTION TQC"},
            {teams: "BOTTOM", role_categories: "SUPPORT", position_1st: "BOTTOM INSPECTOR", position_2nd: "QIP REPAIRING TEAM", position_3rd: "BOTTOM REPAIRING & PACKING TQC"},
            {teams: "CUTTING", role_categories: "TOP-MANAGEMENT", position_1st: "(V) SUPERVISOR", position_2nd: "(V) SUPERVISOR", position_3rd: "ALL CUTTING BUILDING QUALITY IN CHARGE"},
            {teams: "CUTTING", role_categories: "MID-MANAGEMENT", position_1st: "LINE LEADER", position_2nd: "LINE LEADER(SUVERVISOR SUCCESSOR)", position_3rd: "LINE LEADER(SUVERVISOR SUCCESSOR)"},
            {teams: "CUTTING", role_categories: "", position_1st: "CUTTING INSPECTOR", position_2nd: "CUTTING INSPECTOR", position_3rd: "CUTTING INSPECTOR"},
            {teams: "MTL", role_categories: "MID-MANAGEMENT", position_1st: "GROUP LEADER", position_2nd: "GROUP LEADER", position_3rd: "MTL QUALITY IN CHARGE"},
            {teams: "MTL", role_categories: "MID-MANAGEMENT", position_1st: "LINE LEADER", position_2nd: "LINE LEADER(GROUP LEADER SUCCESSOR)", position_3rd: "LINE LEADER(GROUP LEADER SUCCESSOR)"},
            {teams: "MTL", role_categories: "INSPECTOR", position_1st: "RQC", position_2nd: "LEATHER MTL TEAM LEADER", position_3rd: "LEATHER MTL TEAM LEADER"},
            {teams: "MTL", role_categories: "INSPECTOR", position_1st: "RQC", position_2nd: "SUBSI MTL TEAM LEADER", position_3rd: "SUBSI MTL TEAM LEADER"},
            {teams: "MTL", role_categories: "INSPECTOR", position_1st: "RQC", position_2nd: "TEXTILE MTL TEAM LEADER", position_3rd: "TEXTILE MTL TEAM LEADER"},
            {teams: "MTL", role_categories: "INSPECTOR", position_1st: "RQC", position_2nd: "HAPPO MTL TEAM LEADER", position_3rd: "HAPPO MTL TEAM LEADER"},
            {teams: "MTL", role_categories: "INSPECTOR", position_1st: "MTL INSPECTOR", position_2nd: "LEATHER TQC", position_3rd: "LEATHER TQC"},
            {teams: "MTL", role_categories: "INSPECTOR", position_1st: "MTL INSPECTOR", position_2nd: "SUBSI TQC", position_3rd: "SUBSI TQC"},
            {teams: "MTL", role_categories: "INSPECTOR", position_1st: "MTL INSPECTOR", position_2nd: "TEXTILE TQC", position_3rd: "TEXTILE TQC"},
            {teams: "MTL", role_categories: "INSPECTOR", position_1st: "MTL INSPECTOR", position_2nd: "HAPPO TQC", position_3rd: "HAPPO TQC"},
            {teams: "NEW", role_categories: "NEW", position_1st: "NEW", position_2nd: "NEW", position_3rd: "NEW"},
            {teams: "OFFICE & OCPT", role_categories: "TOP-MANAGEMENT", position_1st: "(V) SUPERVISOR", position_2nd: "(V) SUPERVISOR", position_3rd: "OCPT AND OFFICE TEAM LEADER"},
            {teams: "OFFICE & OCPT", role_categories: "REPORT", position_1st: "OCPT STFF", position_2nd: "OCPT STFF", position_3rd: "OCPT TEAM STAFF"},
            {teams: "OFFICE & OCPT", role_categories: "REPORT", position_1st: "GROUP LEADER", position_2nd: "REPORT TEAM", position_3rd: "HR REPORT"},
            {teams: "OFFICE & OCPT", role_categories: "REPORT", position_1st: "GROUP LEADER", position_2nd: "REPORT TEAM", position_3rd: "TEAM OPERATION MANAGEMENT"},
            {teams: "OFFICE & OCPT", role_categories: "REPORT", position_1st: "GROUP LEADER", position_2nd: "REPORT TEAM", position_3rd: "QIP SAP & INCOMING QUALITY REPORT"},
            {teams: "OSC", role_categories: "TOP-MANAGEMENT", position_1st: "(V) SUPERVISOR", position_2nd: "(V) SUPERVISOR", position_3rd: "HWK OSC/MTL QUALITY IN CHARGE"},
            {teams: "OSC", role_categories: "MID-MANAGEMENT", position_1st: "GROUP LEADER", position_2nd: "GROUP LEADER", position_3rd: "INHOUSE QUALITY IN CHARGE"},
            {teams: "OSC", role_categories: "MID-MANAGEMENT", position_1st: "LINE LEADER", position_2nd: "LINE LEADER", position_3rd: "INCOMING OSC WH QUALITY IN CHARGE"},
            {teams: "OSC", role_categories: "INSPECTOR", position_1st: "OSC INSPECTOR", position_2nd: "OSC INSPECTOR", position_3rd: "INHOUSE PRINTING INSPECTION RQC"},
            {teams: "OSC", role_categories: "INSPECTOR", position_1st: "OSC INSPECTOR", position_2nd: "OSC INSPECTOR", position_3rd: "INHOUSE PRINTING INSPECTION TQC"},
            {teams: "OSC", role_categories: "INSPECTOR", position_1st: "OSC INSPECTOR", position_2nd: "OSC INSPECTOR", position_3rd: "INHOUSE HF/ NO-SEW INSPECTION RQC"},
            {teams: "OSC", role_categories: "INSPECTOR", position_1st: "OSC INSPECTOR", position_2nd: "OSC INSPECTOR", position_3rd: "INHOUSE HF/ NO-SEW INSPECTION TQC"},
            {teams: "OSC", role_categories: "INSPECTOR", position_1st: "OSC INSPECTOR", position_2nd: "OSC INSPECTOR", position_3rd: "INCOMING WH OSC INSPECTION RQC"},
            {teams: "OSC", role_categories: "INSPECTOR", position_1st: "OSC INSPECTOR", position_2nd: "OSC INSPECTOR", position_3rd: "INCOMING WH OSC INSPECTION TQC"},
            {teams: "QA", role_categories: "TOP-MANAGEMENT", position_1st: "(V) SUPERVISOR", position_2nd: "(V) SUPERVISOR", position_3rd: "QA TEAM IN CHARGE"},
            {teams: "QA", role_categories: "MID-MANAGEMENT", position_1st: "MODEL MASTER", position_2nd: "MODEL MASTER", position_3rd: "MODEL MASTER"},
            {teams: "QA", role_categories: "AUDITOR", position_1st: "AUDIT & TRAINING TEAM", position_2nd: "AUDIT & TRAINING TEAM", position_3rd: "AUDIT & TRAINING TEAM LEADER"},
            {teams: "QA", role_categories: "AUDITOR", position_1st: "AUDIT & TRAINING TEAM", position_2nd: "AUDIT & TRAINING TEAM", position_3rd: "AUDITOR & TRAININER"},
            {teams: "QA", role_categories: "REPORT", position_1st: "QA TEAM", position_2nd: "QA TEAM", position_3rd: "QA TEAM HEAD"},
            {teams: "QA", role_categories: "REPORT", position_1st: "QA TEAM", position_2nd: "QA TEAM", position_3rd: "QA TEAM STAFF"},
            {teams: "HWK QIP", role_categories: "TOP-MANAGEMENT", position_1st: "MANAGER", position_2nd: "MANAGER", position_3rd: "HWK QUALITY IN CHARGE"},
            {teams: "REPACKING", role_categories: "INSPECTOR", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "SHOES INSPECTOR", position_3rd: "REPACKING LINE TQC"},
            {teams: "REPACKING", role_categories: "INSPECTOR", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "SHOES INSPECTOR", position_3rd: "REPACKING LINE RQC"},
            {teams: "REPACKING", role_categories: "MID-MANAGEMENT", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "QIP PO COMPLETION TEAM", position_3rd: "REPACKING LINE PO COMPLETION QUALITY"},
            {teams: "REPACKING", role_categories: "PACKING", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "QIP PACKING TEAM", position_3rd: "REPACKING AREA INPUT-OUTPUT CARTON TQC"},
            {teams: "REPACKING", role_categories: "PACKING", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "QIP PACKING TEAM", position_3rd: "REPACKING LINE PACKING TQC"},
            {teams: "REPACKING", role_categories: "SUPPORT", position_1st: "ASSEMBLY INSPECTOR", position_2nd: "QIP REPAIRING TEAM", position_3rd: "REPACKING LINE REPAIRING TQC"},
            {teams: "STITCHING", role_categories: "TOP-MANAGEMENT", position_1st: "A.MANAGER", position_2nd: "A.MANAGER", position_3rd: "ALL STITCHING BUILDING QUALITY IN CHARGE"},
            {teams: "STITCHING", role_categories: "TOP-MANAGEMENT", position_1st: "(V) SUPERVISOR", position_2nd: "(V) SUPERVISOR", position_3rd: "1 STITCHING BUILDING QUALITY IN CHARGE"},
            {teams: "STITCHING", role_categories: "MID-MANAGEMENT", position_1st: "GROUP LEADER", position_2nd: "HEAD/ GROUP LEADER", position_3rd: "1 STITCHING BUILDING QIP LEADER'S SUCCESSOR 1"},
            {teams: "STITCHING", role_categories: "MID-MANAGEMENT", position_1st: "LINE LEADER", position_2nd: "LINE LEADER(GROUP LEADER SUCCESSOR)", position_3rd: "1 STITCHING BUILDING QIP LEADER'S SUCCESSOR 2"},
            {teams: "STITCHING", role_categories: "INSPECTOR", position_1st: "STITCHING INSPECTOR", position_2nd: "UPPER INSPECTOR", position_3rd: "STITCHING LINE TQC"},
            {teams: "STITCHING", role_categories: "INSPECTOR", position_1st: "STITCHING INSPECTOR", position_2nd: "UPPER INSPECTOR", position_3rd: "STITCHING LINE RQC"}
        ];

        // ìƒ‰ìƒ íŒ”ë ˆíŠ¸
        const colorPalette = [
            '#667eea', '#f56565', '#48bb78', '#ed8936', '#9f7aea',
            '#38b2ac', '#ed64a6', '#ecc94b', '#4299e1', '#a0aec0',
            '#fc8181', '#68d391', '#fbd38d', '#b794f4', '#4fd1c5'
        ];

        // 1. Sunburst Chart êµ¬í˜„
        function createSunburst() {
            const labels = ["ì „ì²´"];
            const parents = [""];
            const values = [1];
            const colors = ["#e0e0e0"];
            
            // ê³„ì¸µë³„ë¡œ ë°ì´í„° ìˆ˜ì§‘
            const teams = {};
            rawData.forEach(row => {
                const teamPath = row.teams;
                const rolePath = `${row.teams}|${row.role_categories || 'NONE'}`;
                const pos1Path = `${rolePath}|${row.position_1st}`;
                const pos2Path = `${pos1Path}|${row.position_2nd}`;
                const pos3Path = `${pos2Path}|${row.position_3rd}`;
                
                // Teams ë ˆë²¨
                if (!teams[teamPath]) {
                    teams[teamPath] = {count: 0, roles: {}};
                    labels.push(row.teams);
                    parents.push("ì „ì²´");
                    values.push(0);
                    colors.push(colorPalette[Object.keys(teams).length % colorPalette.length]);
                }
                teams[teamPath].count++;
                
                // Role Categories ë ˆë²¨
                if (!teams[teamPath].roles[rolePath]) {
                    teams[teamPath].roles[rolePath] = {count: 0, positions1: {}};
                    labels.push(row.role_categories || 'NONE');
                    parents.push(row.teams);
                    values.push(0);
                    colors.push(colorPalette[labels.length % colorPalette.length]);
                }
                teams[teamPath].roles[rolePath].count++;
                
                // Position 1st ë ˆë²¨
                if (!teams[teamPath].roles[rolePath].positions1[pos1Path]) {
                    teams[teamPath].roles[rolePath].positions1[pos1Path] = {count: 0, positions2: {}};
                    labels.push(row.position_1st);
                    parents.push(row.role_categories || 'NONE');
                    values.push(0);
                    colors.push(colorPalette[labels.length % colorPalette.length]);
                }
                teams[teamPath].roles[rolePath].positions1[pos1Path].count++;
                
                // Position 2nd ë ˆë²¨
                if (!teams[teamPath].roles[rolePath].positions1[pos1Path].positions2[pos2Path]) {
                    teams[teamPath].roles[rolePath].positions1[pos1Path].positions2[pos2Path] = {count: 0, positions3: {}};
                    labels.push(row.position_2nd);
                    parents.push(row.position_1st);
                    values.push(0);
                    colors.push(colorPalette[labels.length % colorPalette.length]);
                }
                teams[teamPath].roles[rolePath].positions1[pos1Path].positions2[pos2Path].count++;
                
                // Position 3rd ë ˆë²¨
                if (!teams[teamPath].roles[rolePath].positions1[pos1Path].positions2[pos2Path].positions3[pos3Path]) {
                    teams[teamPath].roles[rolePath].positions1[pos1Path].positions2[pos2Path].positions3[pos3Path] = 1;
                    labels.push(row.position_3rd);
                    parents.push(row.position_2nd);
                    values.push(1);
                    colors.push(colorPalette[labels.length % colorPalette.length]);
                }
            });
            
            // values ì—…ë°ì´íŠ¸
            for (let i = 1; i < labels.length; i++) {
                if (values[i] === 0) {
                    // ìì‹ ë…¸ë“œë“¤ì˜ ê°’ í•©ì‚°
                    let childSum = 0;
                    for (let j = i + 1; j < labels.length; j++) {
                        if (parents[j] === labels[i]) {
                            childSum += values[j];
                        }
                    }
                    values[i] = childSum || 1;
                }
            }
            
            const data = [{
                type: "sunburst",
                labels: labels,
                parents: parents,
                values: values,
                marker: {colors: colors},
                textinfo: "label",
                hovertemplate: '%{label}<br>Count: %{value}<extra></extra>',
                maxdepth: 3
            }];
            
            const layout = {
                margin: {t: 0, l: 0, r: 0, b: 0},
                sunburstcolorway: colorPalette
            };
            
            Plotly.newPlot('sunburst-chart', data, layout, {responsive: true});
        }

        function resetSunburst() {
            createSunburst();
        }

        // 2. Zoomable Treemap êµ¬í˜„
        let currentTreemapLevel = [];
        let treemapHistory = [];

        function createTreemap(data = null, parentPath = []) {
            const container = document.getElementById('treemap-container');
            container.innerHTML = '';
            
            if (!data) {
                // ì´ˆê¸° ë°ì´í„° êµ¬ì¡° ìƒì„±
                const hierarchyMap = {};
                rawData.forEach(row => {
                    if (!hierarchyMap[row.teams]) {
                        hierarchyMap[row.teams] = {
                            name: row.teams,
                            value: 0,
                            children: {}
                        };
                    }
                    hierarchyMap[row.teams].value++;
                });
                
                data = Object.values(hierarchyMap);
                currentTreemapLevel = data;
                treemapHistory = [];
            }
            
            // íŠ¸ë¦¬ë§µ ë ˆì´ì•„ì›ƒ ê³„ì‚°
            const width = container.offsetWidth;
            const height = container.offsetHeight;
            
            // ê°„ë‹¨í•œ íŠ¸ë¦¬ë§µ ì•Œê³ ë¦¬ì¦˜
            const totalValue = data.reduce((sum, d) => sum + d.value, 0);
            let currentX = 0;
            let currentY = 0;
            let rowHeight = height;
            
            data.forEach((item, index) => {
                const itemWidth = (item.value / totalValue) * width;
                
                if (currentX + itemWidth > width) {
                    currentX = 0;
                    currentY += rowHeight / 2;
                    rowHeight = height - currentY;
                }
                
                const cell = document.createElement('div');
                cell.className = 'treemap-cell';
                cell.style.left = currentX + 'px';
                cell.style.top = currentY + 'px';
                cell.style.width = itemWidth + 'px';
                cell.style.height = (rowHeight / 2) + 'px';
                cell.style.backgroundColor = colorPalette[index % colorPalette.length];
                cell.textContent = item.name;
                cell.title = `${item.name}: ${item.value}`;
                
                cell.onclick = () => drillDownTreemap(item, parentPath.concat(item.name));
                
                container.appendChild(cell);
                currentX += itemWidth;
            });
            
            updateTreemapBreadcrumb(parentPath);
        }

        function drillDownTreemap(item, path) {
            // ë‹¤ìŒ ë ˆë²¨ ë°ì´í„° ìƒì„±
            const nextLevelData = [];
            const currentLevel = path.length;
            
            if (currentLevel < 5) {
                // ê° ë ˆë²¨ì— ë§ëŠ” ë°ì´í„° í•„í„°ë§
                rawData.forEach(row => {
                    let match = true;
                    if (currentLevel >= 1 && row.teams !== path[0]) match = false;
                    if (currentLevel >= 2 && row.role_categories !== path[1]) match = false;
                    if (currentLevel >= 3 && row.position_1st !== path[2]) match = false;
                    if (currentLevel >= 4 && row.position_2nd !== path[3]) match = false;
                    
                    if (match) {
                        let nextLevelName = '';
                        switch(currentLevel) {
                            case 1: nextLevelName = row.role_categories || 'NONE'; break;
                            case 2: nextLevelName = row.position_1st; break;
                            case 3: nextLevelName = row.position_2nd; break;
                            case 4: nextLevelName = row.position_3rd; break;
                        }
                        
                        let existing = nextLevelData.find(d => d.name === nextLevelName);
                        if (!existing) {
                            nextLevelData.push({name: nextLevelName, value: 1});
                        } else {
                            existing.value++;
                        }
                    }
                });
                
                if (nextLevelData.length > 0) {
                    treemapHistory.push({data: currentTreemapLevel, path: path.slice(0, -1)});
                    currentTreemapLevel = nextLevelData;
                    createTreemap(nextLevelData, path);
                }
            }
        }

        function zoomOutTreemap() {
            if (treemapHistory.length > 0) {
                const previous = treemapHistory.pop();
                currentTreemapLevel = previous.data;
                createTreemap(previous.data, previous.path);
            }
        }

        function resetTreemap() {
            createTreemap();
        }

        function updateTreemapBreadcrumb(path) {
            const breadcrumb = document.getElementById('treemap-breadcrumb');
            let html = '<span onclick="resetTreemap()">ì „ì²´</span>';
            path.forEach((item, index) => {
                html += ` > <span onclick="navigateTreemap(${index})">${item}</span>`;
            });
            breadcrumb.innerHTML = html;
        }

        function navigateTreemap(level) {
            if (level === 'root') {
                resetTreemap();
            } else {
                while (treemapHistory.length > level) {
                    zoomOutTreemap();
                }
            }
        }

        // 3. Hybrid Approach êµ¬í˜„
        function createHybrid() {
            // ë©”ì¸ ë·°: ê°„ë‹¨í•œ íŠ¸ë¦¬ë§µ
            const mainData = [{
                type: 'treemap',
                labels: [...new Set(rawData.map(r => r.teams))],
                parents: Array(12).fill(""),
                marker: {colors: colorPalette}
            }];
            
            Plotly.newPlot('hybrid-main', mainData, {
                margin: {t: 0, l: 0, r: 0, b: 0}
            }, {responsive: true});
            
            // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
            document.getElementById('hybrid-main').on('plotly_click', function(data) {
                const team = data.points[0].label;
                showHybridDetail(team);
            });
        }

        function showHybridDetail(team) {
            const detailDiv = document.getElementById('hybrid-detail');
            detailDiv.style.display = 'block';
            
            // ì„ íƒëœ íŒ€ì˜ ìƒì„¸ Sunburst
            const teamData = rawData.filter(r => r.teams === team);
            const labels = [team];
            const parents = [""];
            const values = [teamData.length];
            
            const processed = new Set();
            teamData.forEach(row => {
                // Role Category
                const roleKey = `${team}|${row.role_categories}`;
                if (!processed.has(roleKey)) {
                    labels.push(row.role_categories || 'NONE');
                    parents.push(team);
                    values.push(teamData.filter(r => r.role_categories === row.role_categories).length);
                    processed.add(roleKey);
                }
                
                // Position 1st
                const pos1Key = `${roleKey}|${row.position_1st}`;
                if (!processed.has(pos1Key)) {
                    labels.push(row.position_1st);
                    parents.push(row.role_categories || 'NONE');
                    values.push(1);
                    processed.add(pos1Key);
                }
            });
            
            const data = [{
                type: "sunburst",
                labels: labels,
                parents: parents,
                values: values,
                marker: {colors: colorPalette}
            }];
            
            Plotly.newPlot('hybrid-detail', data, {
                margin: {t: 0, l: 0, r: 0, b: 0}
            }, {responsive: true});
        }

        function toggleHybridView() {
            const detail = document.getElementById('hybrid-detail');
            if (detail.style.display === 'none') {
                detail.style.display = 'block';
            } else {
                detail.style.display = 'none';
            }
        }

        function resetHybrid() {
            createHybrid();
            document.getElementById('hybrid-detail').style.display = 'none';
        }

        // 4. Collapsible Tree êµ¬í˜„
        let treeData, root, tree, svg, g;

        function createCollapsibleTree() {
            // ê³„ì¸µ êµ¬ì¡° ë°ì´í„° ìƒì„±
            treeData = {
                name: "ì „ì²´",
                children: []
            };
            
            const teamMap = {};
            rawData.forEach(row => {
                // Team ë ˆë²¨
                if (!teamMap[row.teams]) {
                    teamMap[row.teams] = {
                        name: row.teams,
                        children: []
                    };
                    treeData.children.push(teamMap[row.teams]);
                }
                
                // Role Category ë ˆë²¨
                let roleNode = teamMap[row.teams].children.find(r => r.name === (row.role_categories || 'NONE'));
                if (!roleNode) {
                    roleNode = {
                        name: row.role_categories || 'NONE',
                        children: []
                    };
                    teamMap[row.teams].children.push(roleNode);
                }
                
                // Position 1st ë ˆë²¨
                let pos1Node = roleNode.children.find(p => p.name === row.position_1st);
                if (!pos1Node) {
                    pos1Node = {
                        name: row.position_1st,
                        children: []
                    };
                    roleNode.children.push(pos1Node);
                }
                
                // Position 2nd ë ˆë²¨
                let pos2Node = pos1Node.children.find(p => p.name === row.position_2nd);
                if (!pos2Node) {
                    pos2Node = {
                        name: row.position_2nd,
                        children: []
                    };
                    pos1Node.children.push(pos2Node);
                }
                
                // Position 3rd ë ˆë²¨
                let pos3Node = pos2Node.children.find(p => p.name === row.position_3rd);
                if (!pos3Node) {
                    pos3Node = {
                        name: row.position_3rd
                    };
                    pos2Node.children.push(pos3Node);
                }
            });
            
            // D3.js íŠ¸ë¦¬ ìƒì„±
            const margin = {top: 20, right: 90, bottom: 30, left: 90};
            const width = document.getElementById('tree-chart').offsetWidth - margin.left - margin.right;
            const height = 580 - margin.top - margin.bottom;
            
            svg = d3.select("#tree-svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom);
            
            g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            tree = d3.tree().size([height, width]);
            
            root = d3.hierarchy(treeData);
            root.x0 = height / 2;
            root.y0 = 0;
            
            // ì´ˆê¸°ì—ëŠ” ì²« ë²ˆì§¸ ë ˆë²¨ë§Œ í¼ì¹¨
            root.children.forEach(collapse);
            
            update(root);
        }

        function collapse(d) {
            if (d.children) {
                d._children = d.children;
                d._children.forEach(collapse);
                d.children = null;
            }
        }

        function update(source) {
            const treeData = tree(root);
            const nodes = treeData.descendants();
            const links = treeData.descendants().slice(1);
            
            nodes.forEach(d => {
                d.y = d.depth * 180;
            });
            
            // ë…¸ë“œ ì—…ë°ì´íŠ¸
            const node = g.selectAll(".node")
                .data(nodes, d => d.id || (d.id = Math.random()));
            
            const nodeEnter = node.enter().append("g")
                .attr("class", "node")
                .attr("transform", d => `translate(${source.y0},${source.x0})`)
                .on("click", click);
            
            nodeEnter.append("circle")
                .attr("r", 1e-6)
                .style("fill", d => d._children ? "#667eea" : "#fff");
            
            nodeEnter.append("text")
                .attr("dy", ".35em")
                .attr("x", d => d.children || d._children ? -13 : 13)
                .attr("text-anchor", d => d.children || d._children ? "end" : "start")
                .text(d => d.data.name)
                .style("font-size", "11px");
            
            const nodeUpdate = nodeEnter.merge(node);
            
            nodeUpdate.transition()
                .duration(750)
                .attr("transform", d => `translate(${d.y},${d.x})`);
            
            nodeUpdate.select("circle")
                .attr("r", 6)
                .style("fill", d => d._children ? "#667eea" : "#fff");
            
            const nodeExit = node.exit().transition()
                .duration(750)
                .attr("transform", d => `translate(${source.y},${source.x})`)
                .remove();
            
            nodeExit.select("circle")
                .attr("r", 1e-6);
            
            nodeExit.select("text")
                .style("fill-opacity", 1e-6);
            
            // ë§í¬ ì—…ë°ì´íŠ¸
            const link = g.selectAll(".link")
                .data(links, d => d.id);
            
            const linkEnter = link.enter().insert("path", "g")
                .attr("class", "link")
                .attr("d", d => {
                    const o = {x: source.x0, y: source.y0};
                    return diagonal(o, o);
                });
            
            const linkUpdate = linkEnter.merge(link);
            
            linkUpdate.transition()
                .duration(750)
                .attr("d", d => diagonal(d, d.parent));
            
            link.exit().transition()
                .duration(750)
                .attr("d", d => {
                    const o = {x: source.x, y: source.y};
                    return diagonal(o, o);
                })
                .remove();
            
            nodes.forEach(d => {
                d.x0 = d.x;
                d.y0 = d.y;
            });
        }

        function diagonal(s, d) {
            return `M ${s.y} ${s.x}
                    C ${(s.y + d.y) / 2} ${s.x},
                      ${(s.y + d.y) / 2} ${d.x},
                      ${d.y} ${d.x}`;
        }

        function click(event, d) {
            if (d.children) {
                d._children = d.children;
                d.children = null;
            } else {
                d.children = d._children;
                d._children = null;
            }
            update(d);
        }

        function expandAllTree() {
            expand(root);
            update(root);
        }

        function expand(d) {
            if (d._children) {
                d.children = d._children;
                d._children = null;
            }
            if (d.children) {
                d.children.forEach(expand);
            }
        }

        function collapseAllTree() {
            root.children.forEach(collapse);
            update(root);
        }

        function resetTreeView() {
            collapseAllTree();
            root.children.forEach(d => {
                if (d._children) {
                    d.children = d._children;
                    d._children = null;
                }
            });
            update(root);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ëª¨ë“  ì°¨íŠ¸ ì´ˆê¸°í™”
        window.onload = function() {
            createSunburst();
            createTreemap();
            createHybrid();
            createCollapsibleTree();
        };
    </script>
</body>
</html>