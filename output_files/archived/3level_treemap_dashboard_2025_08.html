<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR Management Dashboard - 2025ÎÖÑ 8Ïõî</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .dashboard-container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 36px;
            margin-bottom: 10px;
        }
        
        .header .date {
            font-size: 18px;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .section-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin: 30px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        /* 3Îã®Í≥Ñ Ï§ëÏ≤© Ìä∏Î¶¨Îßµ Ïä§ÌÉÄÏùº */
        .treemap-container {
            position: relative;
            width: 100%;
            height: 600px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 30px;
        }
        
        .treemap-level-1 {
            position: absolute;
            border: 2px solid #333;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .treemap-level-2 {
            position: absolute;
            border: 1px solid rgba(255,255,255,0.3);
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .treemap-level-3 {
            position: absolute;
            border: 1px solid rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .treemap-level-1:hover,
        .treemap-level-2:hover,
        .treemap-level-3:hover {
            transform: scale(1.02);
            z-index: 100;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .treemap-label {
            position: absolute;
            top: 2px;
            left: 4px;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            pointer-events: none;
            z-index: 10;
        }
        
        .treemap-label-1 {
            font-size: 16px;
        }
        
        .treemap-label-2 {
            font-size: 13px;
        }
        
        .treemap-label-3 {
            font-size: 10px;
        }
        
        .treemap-info {
            position: absolute;
            bottom: 4px;
            right: 4px;
            font-size: 11px;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            pointer-events: none;
            z-index: 10;
        }
        
        /* ÌÖçÏä§Ìä∏ Ï∂ïÏïΩ Ïä§ÌÉÄÏùº */
        .abbreviated {
            font-size: 9px !important;
        }
        
        /* Sunburst Ï∞®Ìä∏ Î™®Îã¨ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 1200px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: #000;
        }
        
        .sunburst-container {
            height: 600px;
            margin: 20px 0;
        }
        
        /* Î≤îÎ°Ä */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        
        .stat-change {
            font-size: 14px;
            margin-top: 10px;
            font-weight: bold;
        }
        
        .positive {
            color: #00C851;
        }
        
        .negative {
            color: #CC0000;
        }
        
        .neutral {
            color: #757575;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="header">
            <h1>HR Management Dashboard</h1>
            <div class="date">2025ÎÖÑ 8Ïõî | Generated: 2025-09-02 20:49</div>
        </div>
        
        <div class="content">
            <div class="section-title">üìä 3Îã®Í≥Ñ Ï§ëÏ≤© Ìä∏Î¶¨Îßµ - ÌåÄÎ≥Ñ Ïù∏Ïõê Î∂ÑÌè¨</div>
            <div class="treemap-container" id="nested-treemap"></div>
            
            <div class="legend" id="treemap-legend"></div>
            
            <div class="section-title">üìà Ï£ºÏöî ÌÜµÍ≥Ñ</div>
            <div class="stats-grid" id="stats-grid"></div>
        </div>
    </div>
    
    <!-- Sunburst ÏÉÅÏÑ∏ Î∑∞ Î™®Îã¨ -->
    <div id="sunburstModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modal-title">ÏÉÅÏÑ∏ Í≥ÑÏ∏µ Íµ¨Ï°∞</h2>
            <div class="sunburst-container" id="sunburst-chart"></div>
            <div id="modal-stats"></div>
        </div>
    </div>
    
    <script>
        // Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ
        const hierarchyData = [{"teams": "AQL", "role_categories": "CFA", "position_1st": "AQL INSPECTOR", "position_2nd": "AQL INSPECTOR", "position_3rd": "AQL INSPECTOR", "type": "TYPE-1"}, {"teams": "AQL", "role_categories": "PACKING", "position_1st": "AQL INSPECTOR", "position_2nd": "QIP PACKING TEAM", "position_3rd": "FG WH INPUT-OUTPUT CARTON RQC", "type": "TYPE-2"}, {"teams": "AQL", "role_categories": "PACKING", "position_1st": "AQL INSPECTOR", "position_2nd": "QIP PACKING TEAM", "position_3rd": "FG WH CARTON PACKING RQC", "type": "TYPE-2"}, {"teams": "AQL", "role_categories": "PACKING", "position_1st": "AQL INSPECTOR", "position_2nd": "QIP PACKING TEAM", "position_3rd": "FG WH CARTON PACKING TQC", "type": "TYPE-2"}, {"teams": "AQL", "role_categories": "PACKING", "position_1st": "AQL INSPECTOR", "position_2nd": "QIP PACKING TEAM", "position_3rd": "AQL INPUT CARTON TQC", "type": "TYPE-2"}, {"teams": "AQL", "role_categories": "PACKING", "position_1st": "AQL INSPECTOR", "position_2nd": "QIP PACKING TEAM", "position_3rd": "AQL ROOM PACKING TQC", "type": "TYPE-2"}, {"teams": "AQL", "role_categories": "REPORT", "position_1st": "AQL INSPECTOR", "position_2nd": "REPORT TEAM", "position_3rd": "AQL REPORT TEAM", "type": "TYPE-2"}, {"teams": "AQL", "role_categories": "REPORT", "position_1st": "GROUP LEADER", "position_2nd": "REPORT TEAM", "position_3rd": "AQL REPORT TEAM", "type": "TYPE-2"}, {"teams": "ASSEMBLY", "role_categories": "TOP-MANAGEMENT", "position_1st": "A.MANAGER", "position_2nd": "A.MANAGER", "position_3rd": "ALL ASSEMBLY BUILDING QUALITY IN CHARGE", "type": "TYPE-1"}, {"teams": "ASSEMBLY", "role_categories": "TOP-MANAGEMENT", "position_1st": "(V) SUPERVISOR", "position_2nd": "(V) SUPERVISOR", "position_3rd": "2 ASSEMBLY BUILDING QUALITY IN CHARGE", "type": "TYPE-1"}, {"teams": "ASSEMBLY", "role_categories": "MID-MANAGEMENT", "position_1st": "GROUP LEADER", "position_2nd": "GROUP LEADER", "position_3rd": "1 ASSEMBLY BUILDING QUALITY IN CHARGE", "type": "TYPE-1"}, {"teams": "ASSEMBLY", "role_categories": "MID-MANAGEMENT", "position_1st": "LINE LEADER", "position_2nd": "LINE LEADER(GROUP LEADER SUCCESSOR)", "position_3rd": "12 ASSEMBLY LINE QUALITY IN CHARGE", "type": "TYPE-1"}, {"teams": "ASSEMBLY", "role_categories": "INSPECTOR", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "SHOES INSPECTOR", "position_3rd": "ASSEMBLY LINE TQC", "type": "TYPE-1"}, {"teams": "ASSEMBLY", "role_categories": "INSPECTOR", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "SHOES INSPECTOR", "position_3rd": "ASSEMBLY LINE RQC", "type": "TYPE-1"}, {"teams": "ASSEMBLY", "role_categories": "PO COMPLETION", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "QIP PO COMPLETION TEAM", "position_3rd": "ASSEMBLY LINE PO COMPLETION QUALITY", "type": "TYPE-2"}, {"teams": "ASSEMBLY", "role_categories": "SUPPORT", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "B-GRADE TEAM / TEST SAMPLE HANDLING TEAM", "position_3rd": "ASSEMBLY LINE RQC", "type": "TYPE-2"}, {"teams": "ASSEMBLY", "role_categories": "SUPPORT", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "B-GRADE TEAM / TEST SAMPLE HANDLING TEAM", "position_3rd": "ALL B-GRADE CONTROL & PACKING", "type": "TYPE-2"}, {"teams": "ASSEMBLY", "role_categories": "PACKING", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "QIP PACKING TEAM", "position_3rd": "SCAN PACK AREA TQC", "type": "TYPE-2"}, {"teams": "BOTTOM", "role_categories": "MID-MANAGEMENT", "position_1st": "GROUP LEADER", "position_2nd": "HEAD/ GROUP LEADER", "position_3rd": "ALL BUILDING BOTTOM QUALITY IN CHARGE", "type": "TYPE-2"}, {"teams": "BOTTOM", "role_categories": "MID-MANAGEMENT", "position_1st": "LINE LEADER", "position_2nd": "LINE LEADER(GROUP LEADER SUCCESSOR)", "position_3rd": "1 BUILDING BOTTOM QUALITY IN CHARGE", "type": "TYPE-2"}, {"teams": "BOTTOM", "role_categories": "INSPECTOR", "position_1st": "BOTTOM INSPECTOR", "position_2nd": "BOTTOM INSPECTOR", "position_3rd": "BOTTOM INSPECTION RQC", "type": "TYPE-2"}, {"teams": "BOTTOM", "role_categories": "INSPECTOR", "position_1st": "BOTTOM INSPECTOR", "position_2nd": "BOTTOM INSPECTOR", "position_3rd": "BOTTOM INSPECTION TQC", "type": "TYPE-2"}, {"teams": "BOTTOM", "role_categories": "SUPPORT", "position_1st": "BOTTOM INSPECTOR", "position_2nd": "QIP REPAIRING TEAM", "position_3rd": "BOTTOM REPAIRING & PACKING TQC", "type": "TYPE-2"}, {"teams": "CUTTING", "role_categories": "TOP-MANAGEMENT", "position_1st": "(V) SUPERVISOR", "position_2nd": "(V) SUPERVISOR", "position_3rd": "ALL CUTTING BUILDING QUALITY IN CHARGE", "type": "TYPE-2"}, {"teams": "CUTTING", "role_categories": "MID-MANAGEMENT", "position_1st": "LINE LEADER", "position_2nd": "LINE LEADER(SUVERVISOR SUCCESSOR)", "position_3rd": "LINE LEADER(SUVERVISOR SUCCESSOR)", "type": "TYPE-2"}, {"teams": "CUTTING", "role_categories": NaN, "position_1st": "CUTTING INSPECTOR", "position_2nd": "CUTTING INSPECTOR", "position_3rd": "CUTTING INSPECTOR", "type": "TYPE-2"}, {"teams": "MTL", "role_categories": "MID-MANAGEMENT", "position_1st": "GROUP LEADER", "position_2nd": "GROUP LEADER", "position_3rd": "MTL QUALITY IN CHARGE", "type": "TYPE-2"}, {"teams": "MTL", "role_categories": "MID-MANAGEMENT", "position_1st": "LINE LEADER", "position_2nd": "LINE LEADER(GROUP LEADER SUCCESSOR)", "position_3rd": "LINE LEADER(GROUP LEADER SUCCESSOR)", "type": "TYPE-2"}, {"teams": "MTL", "role_categories": "INSPECTOR", "position_1st": "RQC", "position_2nd": "LEATHER MTL TEAM LEADER", "position_3rd": "LEATHER MTL TEAM LEADER", "type": "TYPE-2"}, {"teams": "MTL", "role_categories": "INSPECTOR", "position_1st": "RQC", "position_2nd": "SUBSI MTL TEAM LEADER", "position_3rd": "SUBSI MTL TEAM LEADER", "type": "TYPE-2"}, {"teams": "MTL", "role_categories": "INSPECTOR", "position_1st": "RQC", "position_2nd": "TEXTILE MTL TEAM LEADER", "position_3rd": "TEXTILE MTL TEAM LEADER", "type": "TYPE-2"}, {"teams": "MTL", "role_categories": "INSPECTOR", "position_1st": "RQC", "position_2nd": "HAPPO MTL TEAM LEADER", "position_3rd": "HAPPO MTL TEAM LEADER", "type": "TYPE-2"}, {"teams": "MTL", "role_categories": "INSPECTOR", "position_1st": "MTL INSPECTOR", "position_2nd": "LEATHER TQC", "position_3rd": "LEATHER TQC", "type": "TYPE-2"}, {"teams": "MTL", "role_categories": "INSPECTOR", "position_1st": "MTL INSPECTOR", "position_2nd": "SUBSI TQC", "position_3rd": "SUBSI TQC", "type": "TYPE-2"}, {"teams": "MTL", "role_categories": "INSPECTOR", "position_1st": "MTL INSPECTOR", "position_2nd": "TEXTILE TQC", "position_3rd": "TEXTILE TQC", "type": "TYPE-2"}, {"teams": "MTL", "role_categories": "INSPECTOR", "position_1st": "MTL INSPECTOR", "position_2nd": "HAPPO TQC", "position_3rd": "HAPPO TQC", "type": "TYPE-2"}, {"teams": "NEW", "role_categories": "NEW", "position_1st": "NEW", "position_2nd": "NEW", "position_3rd": "NEW", "type": "TYPE-3"}, {"teams": "OFFICE & OCPT", "role_categories": "TOP-MANAGEMENT", "position_1st": "(V) SUPERVISOR", "position_2nd": "(V) SUPERVISOR", "position_3rd": "OCPT AND OFFICE TEAM LEADER", "type": "TYPE-2"}, {"teams": "OFFICE & OCPT", "role_categories": "REPORT", "position_1st": "OCPT STFF", "position_2nd": "OCPT STFF", "position_3rd": "OCPT TEAM STAFF", "type": "TYPE-2"}, {"teams": "OFFICE & OCPT", "role_categories": "REPORT", "position_1st": "GROUP LEADER", "position_2nd": "REPORT TEAM", "position_3rd": "HR REPORT", "type": "TYPE-2"}, {"teams": "OFFICE & OCPT", "role_categories": "REPORT", "position_1st": "GROUP LEADER", "position_2nd": "REPORT TEAM", "position_3rd": "TEAM OPERATION MANAGEMENT", "type": "TYPE-2"}, {"teams": "OFFICE & OCPT", "role_categories": "REPORT", "position_1st": "GROUP LEADER", "position_2nd": "REPORT TEAM", "position_3rd": "QIP SAP & INCOMING QUALITY REPORT", "type": "TYPE-2"}, {"teams": "OSC", "role_categories": "TOP-MANAGEMENT", "position_1st": "(V) SUPERVISOR", "position_2nd": "(V) SUPERVISOR", "position_3rd": "HWK OSC/MTL QUALITY IN CHARGE", "type": "TYPE-2"}, {"teams": "OSC", "role_categories": "MID-MANAGEMENT", "position_1st": "GROUP LEADER", "position_2nd": "GROUP LEADER", "position_3rd": "INHOUSE QUALITY IN CHARGE", "type": "TYPE-2"}, {"teams": "OSC", "role_categories": "MID-MANAGEMENT", "position_1st": "LINE LEADER", "position_2nd": "LINE LEADER", "position_3rd": "INCOMING OSC WH QUALITY IN CHARGE", "type": "TYPE-2"}, {"teams": "OSC", "role_categories": "INSPECTOR", "position_1st": "OSC INSPECTOR", "position_2nd": "OSC INSPECTOR", "position_3rd": "INHOUSE PRINTING INSPECTION RQC", "type": "TYPE-2"}, {"teams": "OSC", "role_categories": "INSPECTOR", "position_1st": "OSC INSPECTOR", "position_2nd": "OSC INSPECTOR", "position_3rd": "INHOUSE PRINTING INSPECTION TQC", "type": "TYPE-2"}, {"teams": "OSC", "role_categories": "INSPECTOR", "position_1st": "OSC INSPECTOR", "position_2nd": "OSC INSPECTOR", "position_3rd": "INHOUSE HF/ NO-SEW INSPECTION RQC", "type": "TYPE-2"}, {"teams": "OSC", "role_categories": "INSPECTOR", "position_1st": "OSC INSPECTOR", "position_2nd": "OSC INSPECTOR", "position_3rd": "INHOUSE HF/ NO-SEW INSPECTION TQC", "type": "TYPE-2"}, {"teams": "OSC", "role_categories": "INSPECTOR", "position_1st": "OSC INSPECTOR", "position_2nd": "OSC INSPECTOR", "position_3rd": "INCOMING WH OSC INSPECTION RQC", "type": "TYPE-2"}, {"teams": "OSC", "role_categories": "INSPECTOR", "position_1st": "OSC INSPECTOR", "position_2nd": "OSC INSPECTOR", "position_3rd": "INCOMING WH OSC INSPECTION TQC", "type": "TYPE-2"}, {"teams": "QA", "role_categories": "TOP-MANAGEMENT", "position_1st": "(V) SUPERVISOR", "position_2nd": "(V) SUPERVISOR", "position_3rd": "QA TEAM IN CHARGE", "type": "TYPE-2"}, {"teams": "QA", "role_categories": "MID-MANAGEMENT", "position_1st": "MODEL MASTER", "position_2nd": "MODEL MASTER", "position_3rd": "MODEL MASTER", "type": "TYPE-1"}, {"teams": "QA", "role_categories": "AUDITOR", "position_1st": "AUDIT & TRAINING TEAM", "position_2nd": "AUDIT & TRAINING TEAM", "position_3rd": "AUDIT & TRAINING TEAM LEADER", "type": "TYPE-1"}, {"teams": "QA", "role_categories": "AUDITOR", "position_1st": "AUDIT & TRAINING TEAM", "position_2nd": "AUDIT & TRAINING TEAM", "position_3rd": "AUDITOR & TRAININER", "type": "TYPE-1"}, {"teams": "QA", "role_categories": "REPORT", "position_1st": "QA TEAM", "position_2nd": "QA TEAM", "position_3rd": "QA TEAM HEAD", "type": "TYPE-2"}, {"teams": "QA", "role_categories": "REPORT", "position_1st": "QA TEAM", "position_2nd": "QA TEAM", "position_3rd": "QA TEAM STAFF", "type": "TYPE-2"}, {"teams": "HWK QIP", "role_categories": "TOP-MANAGEMENT", "position_1st": "MANAGER", "position_2nd": "MANAGER", "position_3rd": "HWK QUALITY IN CHARGE", "type": "TYPE-1"}, {"teams": "REPACKING", "role_categories": "INSPECTOR", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "SHOES INSPECTOR", "position_3rd": "REPACKING LINE TQC", "type": "TYPE-1"}, {"teams": "REPACKING", "role_categories": "INSPECTOR", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "SHOES INSPECTOR", "position_3rd": "REPACKING LINE RQC", "type": "TYPE-1"}, {"teams": "REPACKING", "role_categories": "MID-MANAGEMENT", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "QIP PO COMPLETION TEAM", "position_3rd": "REPACKING LINE PO COMPLETION QUALITY", "type": "TYPE-2"}, {"teams": "REPACKING", "role_categories": "PACKING", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "QIP PACKING TEAM", "position_3rd": "REPACKING AREA INPUT-OUTPUT CARTON TQC", "type": "TYPE-2"}, {"teams": "REPACKING", "role_categories": "PACKING", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "QIP PACKING TEAM", "position_3rd": "REPACKING LINE PACKING TQC", "type": "TYPE-2"}, {"teams": "REPACKING", "role_categories": "SUPPORT", "position_1st": "ASSEMBLY INSPECTOR", "position_2nd": "QIP REPAIRING TEAM", "position_3rd": "REPACKING LINE REPAIRING TQC", "type": "TYPE-2"}, {"teams": "STITCHING", "role_categories": "TOP-MANAGEMENT", "position_1st": "A.MANAGER", "position_2nd": "A.MANAGER", "position_3rd": "ALL STITCHING BUILDING QUALITY IN CHARGE", "type": "TYPE-2"}, {"teams": "STITCHING", "role_categories": "TOP-MANAGEMENT", "position_1st": "(V) SUPERVISOR", "position_2nd": "(V) SUPERVISOR", "position_3rd": "1 STITCHING BUILDING QUALITY IN CHARGE", "type": "TYPE-2"}, {"teams": "STITCHING", "role_categories": "MID-MANAGEMENT", "position_1st": "GROUP LEADER", "position_2nd": "HEAD/ GROUP LEADER", "position_3rd": "1 STITCHING BUILDING QIP LEADER'S SUCCESSOR 1", "type": "TYPE-2"}, {"teams": "STITCHING", "role_categories": "MID-MANAGEMENT", "position_1st": "LINE LEADER", "position_2nd": "LINE LEADER(GROUP LEADER SUCCESSOR)", "position_3rd": "1 STITCHING BUILDING QIP LEADER'S SUCCESSOR 2", "type": "TYPE-2"}, {"teams": "STITCHING", "role_categories": "INSPECTOR", "position_1st": "STITCHING INSPECTOR", "position_2nd": "UPPER INSPECTOR", "position_3rd": "STITCHING LINE TQC", "type": "TYPE-2"}, {"teams": "STITCHING", "role_categories": "INSPECTOR", "position_1st": "STITCHING INSPECTOR", "position_2nd": "UPPER INSPECTOR", "position_3rd": "STITCHING LINE RQC", "type": "TYPE-2"}];
        const teamStats = {"AQL": {"current": 8, "previous": 0, "change": 0, "change_percent": 0, "roles": {"CFA": {"current": 1, "positions": {"AQL INSPECTOR": 1}}, "PACKING": {"current": 5, "positions": {"AQL INSPECTOR": 5}}, "REPORT": {"current": 2, "positions": {"AQL INSPECTOR": 1, "GROUP LEADER": 1}}}}, "ASSEMBLY": {"current": 10, "previous": 0, "change": 0, "change_percent": 0, "roles": {"TOP-MANAGEMENT": {"current": 2, "positions": {"A.MANAGER": 1, "(V) SUPERVISOR": 1}}, "MID-MANAGEMENT": {"current": 2, "positions": {"GROUP LEADER": 1, "LINE LEADER": 1}}, "INSPECTOR": {"current": 2, "positions": {"ASSEMBLY INSPECTOR": 2}}, "PO COMPLETION": {"current": 1, "positions": {"ASSEMBLY INSPECTOR": 1}}, "SUPPORT": {"current": 2, "positions": {"ASSEMBLY INSPECTOR": 2}}, "PACKING": {"current": 1, "positions": {"ASSEMBLY INSPECTOR": 1}}}}, "BOTTOM": {"current": 5, "previous": 0, "change": 0, "change_percent": 0, "roles": {"MID-MANAGEMENT": {"current": 2, "positions": {"GROUP LEADER": 1, "LINE LEADER": 1}}, "INSPECTOR": {"current": 2, "positions": {"BOTTOM INSPECTOR": 2}}, "SUPPORT": {"current": 1, "positions": {"BOTTOM INSPECTOR": 1}}}}, "CUTTING": {"current": 3, "previous": 0, "change": 0, "change_percent": 0, "roles": {"TOP-MANAGEMENT": {"current": 1, "positions": {"(V) SUPERVISOR": 1}}, "MID-MANAGEMENT": {"current": 1, "positions": {"LINE LEADER": 1}}}}, "MTL": {"current": 10, "previous": 0, "change": 0, "change_percent": 0, "roles": {"MID-MANAGEMENT": {"current": 2, "positions": {"GROUP LEADER": 1, "LINE LEADER": 1}}, "INSPECTOR": {"current": 8, "positions": {"RQC": 4, "MTL INSPECTOR": 4}}}}, "NEW": {"current": 1, "previous": 0, "change": 0, "change_percent": 0, "roles": {"NEW": {"current": 1, "positions": {"NEW": 1}}}}, "OFFICE & OCPT": {"current": 5, "previous": 0, "change": 0, "change_percent": 0, "roles": {"TOP-MANAGEMENT": {"current": 1, "positions": {"(V) SUPERVISOR": 1}}, "REPORT": {"current": 4, "positions": {"OCPT STFF": 1, "GROUP LEADER": 3}}}}, "OSC": {"current": 9, "previous": 0, "change": 0, "change_percent": 0, "roles": {"TOP-MANAGEMENT": {"current": 1, "positions": {"(V) SUPERVISOR": 1}}, "MID-MANAGEMENT": {"current": 2, "positions": {"GROUP LEADER": 1, "LINE LEADER": 1}}, "INSPECTOR": {"current": 6, "positions": {"OSC INSPECTOR": 6}}}}, "QA": {"current": 6, "previous": 0, "change": 0, "change_percent": 0, "roles": {"TOP-MANAGEMENT": {"current": 1, "positions": {"(V) SUPERVISOR": 1}}, "MID-MANAGEMENT": {"current": 1, "positions": {"MODEL MASTER": 1}}, "AUDITOR": {"current": 2, "positions": {"AUDIT & TRAINING TEAM": 2}}, "REPORT": {"current": 2, "positions": {"QA TEAM": 2}}}}, "HWK QIP": {"current": 1, "previous": 0, "change": 0, "change_percent": 0, "roles": {"TOP-MANAGEMENT": {"current": 1, "positions": {"MANAGER": 1}}}}, "REPACKING": {"current": 6, "previous": 0, "change": 0, "change_percent": 0, "roles": {"INSPECTOR": {"current": 2, "positions": {"ASSEMBLY INSPECTOR": 2}}, "MID-MANAGEMENT": {"current": 1, "positions": {"ASSEMBLY INSPECTOR": 1}}, "PACKING": {"current": 2, "positions": {"ASSEMBLY INSPECTOR": 2}}, "SUPPORT": {"current": 1, "positions": {"ASSEMBLY INSPECTOR": 1}}}}, "STITCHING": {"current": 6, "previous": 0, "change": 0, "change_percent": 0, "roles": {"TOP-MANAGEMENT": {"current": 2, "positions": {"A.MANAGER": 1, "(V) SUPERVISOR": 1}}, "MID-MANAGEMENT": {"current": 2, "positions": {"GROUP LEADER": 1, "LINE LEADER": 1}}, "INSPECTOR": {"current": 2, "positions": {"STITCHING INSPECTOR": 2}}}}};
        
        // ÌÖçÏä§Ìä∏ Ï∂ïÏïΩ Ìï®Ïàò
        function abbreviateText(text, maxLength) {
            const abbreviations = {
                'ASSEMBLY INSPECTOR': 'ASM INSP',
                'BOTTOM INSPECTOR': 'BTM INSP',
                'STITCHING INSPECTOR': 'STH INSP',
                'CUTTING INSPECTOR': 'CUT INSP',
                'OSC INSPECTOR': 'OSC INSP',
                'MTL INSPECTOR': 'MTL INSP',
                'QA INSPECTOR': 'QA INSP',
                'AQL INSPECTOR': 'AQL INSP',
                'GROUP LEADER': 'GRP LDR',
                'LINE LEADER': 'LINE LDR',
                'TEAM LEADER': 'TEAM LDR',
                'SUPERVISOR': 'SUPV',
                'MANAGER': 'MGR',
                'TOP-MANAGEMENT': 'TOP-MGT',
                'MID-MANAGEMENT': 'MID-MGT',
                'INSPECTOR': 'INSP',
                'SUPPORT': 'SUPP',
                'PACKING': 'PACK',
                'REPORT': 'RPT',
                'AUDITOR': 'AUD'
            };
            
            // ÎØ∏Î¶¨ Ï†ïÏùòÎêú Ï∂ïÏïΩÏñ¥Í∞Ä ÏûàÏúºÎ©¥ ÏÇ¨Ïö©
            if (abbreviations[text]) {
                return abbreviations[text];
            }
            
            // ÎÑàÎ¨¥ Í∏¥ ÌÖçÏä§Ìä∏Îäî ÏûòÎùºÎÉÑ
            if (text && text.length > maxLength) {
                return text.substring(0, maxLength) + '...';
            }
            
            return text;
        }
        
        // ÏÉâÏÉÅ Í≥ÑÏÇ∞ Ìï®Ïàò
        function getColorForChange(changePercent) {
            const absPercent = Math.abs(changePercent);
            
            if (changePercent > 0) {
                // ÏñëÏàò: Ï¥àÎ°ùÏÉâ Í∑∏ÎùºÎç∞Ïù¥ÏÖò
                if (absPercent > 15) return '#00C851';
                else if (absPercent > 10) return '#2ECC71';
                else if (absPercent > 5) return '#5CB85C';
                else if (absPercent > 2) return '#7FB069';
                else return '#90C695';
            } else if (changePercent < 0) {
                // ÏùåÏàò: Îπ®Í∞ÑÏÉâ Í∑∏ÎùºÎç∞Ïù¥ÏÖò
                if (absPercent > 15) return '#CC0000';
                else if (absPercent > 10) return '#E74C3C';
                else if (absPercent > 5) return '#D9534F';
                else if (absPercent > 2) return '#E57373';
                else return '#EF9A9A';
            } else {
                return '#757575'; // Î≥ÄÌôî ÏóÜÏùå
            }
        }
        
        // ÌÖçÏä§Ìä∏ ÏÉâÏÉÅ Í≤∞Ï†ï Ìï®Ïàò
        function getTextColor(bgColor) {
            const lightColors = ['#90C695', '#7FB069', '#EF9A9A', '#E57373', '#757575'];
            return lightColors.includes(bgColor) ? '#1a1a1a' : 'white';
        }
        
        // 3Îã®Í≥Ñ Ï§ëÏ≤© Ìä∏Î¶¨Îßµ ÏÉùÏÑ±
        function create3LevelTreemap() {
            const container = document.getElementById('nested-treemap');
            container.innerHTML = '';
            
            const width = container.offsetWidth - 20;
            const height = container.offsetHeight - 20;
            
            // ÌåÄÎ≥Ñ Îç∞Ïù¥ÌÑ∞ ÏßëÍ≥Ñ
            const teams = {};
            hierarchyData.forEach(item => {
                const team = item.teams;
                const role = item.role_categories || 'NONE';
                const pos1 = item.position_1st;
                
                if (!teams[team]) {
                    teams[team] = {
                        count: 0,
                        roles: {}
                    };
                }
                teams[team].count++;
                
                if (!teams[team].roles[role]) {
                    teams[team].roles[role] = {
                        count: 0,
                        positions: {}
                    };
                }
                teams[team].roles[role].count++;
                
                if (!teams[team].roles[role].positions[pos1]) {
                    teams[team].roles[role].positions[pos1] = 0;
                }
                teams[team].roles[role].positions[pos1]++;
            });
            
            // ÌåÄ Ï†ïÎ†¨ (Ïù∏Ïõê Ïàò Í∏∞Ï§Ä)
            const sortedTeams = Object.entries(teams)
                .sort((a, b) => b[1].count - a[1].count)
                .slice(0, 12); // ÏÉÅÏúÑ 12Í∞ú ÌåÄÎßå ÌëúÏãú
            
            // Squarified Treemap ÏïåÍ≥†Î¶¨Ï¶òÏúºÎ°ú Î†àÎ≤® 1 ÏúÑÏπò Í≥ÑÏÇ∞
            const totalCount = sortedTeams.reduce((sum, [_, data]) => sum + data.count, 0);
            let currentX = 10;
            let currentY = 10;
            let rowHeight = height - 20;
            let rowWidth = 0;
            let currentRow = [];
            
            sortedTeams.forEach(([teamName, teamData], index) => {
                const teamWidth = (teamData.count / totalCount) * (width - 20);
                
                // ÏÉà Ìñâ ÏãúÏûë Ï°∞Í±¥
                if (currentX + teamWidth > width - 10 && currentRow.length > 0) {
                    // ÌòÑÏû¨ Ìñâ Î†åÎçîÎßÅ
                    renderRow(currentRow, currentX - rowWidth, currentY, rowWidth, rowHeight / 2);
                    
                    // Îã§Ïùå Ìñâ Ï§ÄÎπÑ
                    currentY += rowHeight / 2;
                    rowHeight = height - currentY - 10;
                    currentX = 10;
                    rowWidth = 0;
                    currentRow = [];
                }
                
                currentRow.push({
                    name: teamName,
                    data: teamData,
                    width: teamWidth
                });
                rowWidth += teamWidth;
                currentX += teamWidth;
            });
            
            // ÎßàÏßÄÎßâ Ìñâ Î†åÎçîÎßÅ
            if (currentRow.length > 0) {
                renderRow(currentRow, 10, currentY, width - 20, rowHeight);
            }
            
            function renderRow(rowTeams, x, y, totalWidth, height) {
                let currentX = x;
                
                rowTeams.forEach(team => {
                    const teamWidth = (team.width / rowTeams.reduce((sum, t) => sum + t.width, 0)) * totalWidth;
                    
                    // ÌåÄ Î∞ïÏä§ (Î†àÎ≤® 1)
                    const teamDiv = document.createElement('div');
                    teamDiv.className = 'treemap-level-1';
                    teamDiv.style.left = currentX + 'px';
                    teamDiv.style.top = y + 'px';
                    teamDiv.style.width = teamWidth + 'px';
                    teamDiv.style.height = height + 'px';
                    
                    // Î≥ÄÌôîÏú® Í≥ÑÏÇ∞
                    const stats = teamStats[team.name] || {};
                    const changePercent = stats.change_percent || 0;
                    teamDiv.style.backgroundColor = getColorForChange(changePercent);
                    
                    // ÌåÄ Î†àÏù¥Î∏î
                    const teamLabel = document.createElement('div');
                    teamLabel.className = 'treemap-label treemap-label-1';
                    teamLabel.textContent = teamWidth < 100 ? abbreviateText(team.name, 10) : team.name;
                    teamLabel.style.color = getTextColor(teamDiv.style.backgroundColor);
                    teamDiv.appendChild(teamLabel);
                    
                    // ÌåÄ Ï†ïÎ≥¥
                    const teamInfo = document.createElement('div');
                    teamInfo.className = 'treemap-info';
                    teamInfo.innerHTML = `${team.data.count}Î™Ö<br>${changePercent >= 0 ? '+' : ''}${changePercent.toFixed(1)}%`;
                    teamInfo.style.color = getTextColor(teamDiv.style.backgroundColor);
                    teamDiv.appendChild(teamInfo);
                    
                    // Ïó≠Ìï†Î≥Ñ Î∞ïÏä§ (Î†àÎ≤® 2)
                    let roleY = 25;
                    const sortedRoles = Object.entries(team.data.roles)
                        .sort((a, b) => b[1].count - a[1].count);
                    
                    sortedRoles.forEach(([roleName, roleData]) => {
                        const roleHeight = (roleData.count / team.data.count) * (height - 30);
                        
                        if (roleHeight > 15) { // ÏµúÏÜå ÎÜíÏù¥
                            const roleDiv = document.createElement('div');
                            roleDiv.className = 'treemap-level-2';
                            roleDiv.style.left = '5px';
                            roleDiv.style.top = roleY + 'px';
                            roleDiv.style.width = (teamWidth - 10) + 'px';
                            roleDiv.style.height = roleHeight + 'px';
                            roleDiv.style.backgroundColor = 'rgba(255,255,255,0.1)';
                            
                            // Ïó≠Ìï† Î†àÏù¥Î∏î
                            if (roleHeight > 25) {
                                const roleLabel = document.createElement('div');
                                roleLabel.className = 'treemap-label treemap-label-2';
                                roleLabel.textContent = teamWidth < 150 ? abbreviateText(roleName, 8) : roleName;
                                roleDiv.appendChild(roleLabel);
                            }
                            
                            // PositionÎ≥Ñ Î∞ïÏä§ (Î†àÎ≤® 3)
                            let posX = 5;
                            const sortedPositions = Object.entries(roleData.positions)
                                .sort((a, b) => b[1] - a[1]);
                            
                            sortedPositions.forEach(([posName, posCount]) => {
                                const posWidth = (posCount / roleData.count) * (teamWidth - 20);
                                
                                if (posWidth > 20) { // ÏµúÏÜå ÎÑàÎπÑ
                                    const posDiv = document.createElement('div');
                                    posDiv.className = 'treemap-level-3';
                                    posDiv.style.left = posX + 'px';
                                    posDiv.style.top = '20px';
                                    posDiv.style.width = posWidth + 'px';
                                    posDiv.style.height = (roleHeight - 25) + 'px';
                                    posDiv.style.backgroundColor = 'rgba(0,0,0,0.2)';
                                    
                                    // Position ÌÖçÏä§Ìä∏
                                    const posText = document.createElement('div');
                                    if (posWidth < 60) {
                                        posText.className = 'abbreviated';
                                        posText.textContent = abbreviateText(posName, 6);
                                    } else {
                                        posText.innerHTML = `${posName}<br>${posCount}Î™Ö`;
                                    }
                                    posDiv.appendChild(posText);
                                    
                                    // ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏ - Sunburst Ï∞®Ìä∏ ÌëúÏãú
                                    posDiv.onclick = () => showSunburstDetail(team.name, roleName, posName);
                                    
                                    roleDiv.appendChild(posDiv);
                                    posX += posWidth;
                                }
                            });
                            
                            teamDiv.appendChild(roleDiv);
                            roleY += roleHeight;
                        }
                    });
                    
                    // ÌåÄ Î∞ïÏä§ ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
                    teamDiv.onclick = (e) => {
                        if (e.target === teamDiv) {
                            showSunburstDetail(team.name);
                        }
                    };
                    
                    container.appendChild(teamDiv);
                    currentX += teamWidth;
                });
            }
        }
        
        // Sunburst ÏÉÅÏÑ∏ Î∑∞ ÌëúÏãú
        function showSunburstDetail(team, role = null, position = null) {
            const modal = document.getElementById('sunburstModal');
            const modalTitle = document.getElementById('modal-title');
            const modalStats = document.getElementById('modal-stats');
            
            // Ï†úÎ™© ÏÑ§Ï†ï
            if (position) {
                modalTitle.textContent = `${team} > ${role} > ${position} ÏÉÅÏÑ∏ Íµ¨Ï°∞`;
            } else if (role) {
                modalTitle.textContent = `${team} > ${role} ÏÉÅÏÑ∏ Íµ¨Ï°∞`;
            } else {
                modalTitle.textContent = `${team} ÌåÄ ÏÉÅÏÑ∏ Íµ¨Ï°∞`;
            }
            
            // Sunburst Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ
            const sunburstData = prepareSunburstData(team, role, position);
            
            // Sunburst Ï∞®Ìä∏ ÏÉùÏÑ±
            const data = [{
                type: 'sunburst',
                labels: sunburstData.labels,
                parents: sunburstData.parents,
                values: sunburstData.values,
                marker: {
                    colors: sunburstData.colors
                },
                textinfo: 'label+value',
                hovertemplate: '%{label}<br>Ïù∏Ïõê: %{value}Î™Ö<extra></extra>'
            }];
            
            const layout = {
                margin: {t: 0, l: 0, r: 0, b: 0},
                width: document.querySelector('.modal-content').offsetWidth - 40,
                height: 600
            };
            
            Plotly.newPlot('sunburst-chart', data, layout);
            
            // ÌÜµÍ≥Ñ Ï†ïÎ≥¥ ÌëúÏãú
            const stats = teamStats[team] || {};
            modalStats.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">${stats.current || 0}</div>
                        <div class="stat-label">ÌòÑÏû¨ Ïù∏Ïõê</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${stats.previous || 0}</div>
                        <div class="stat-label">Ïù¥Ï†Ñ Ïõî Ïù∏Ïõê</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value ${stats.change >= 0 ? 'positive' : 'negative'}">
                            ${stats.change >= 0 ? '+' : ''}${stats.change || 0}
                        </div>
                        <div class="stat-label">Ï¶ùÍ∞ê Ïù∏Ïõê</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value ${stats.change_percent >= 0 ? 'positive' : 'negative'}">
                            ${stats.change_percent >= 0 ? '+' : ''}${(stats.change_percent || 0).toFixed(1)}%
                        </div>
                        <div class="stat-label">Ï¶ùÍ∞êÎ•†</div>
                    </div>
                </div>
            `;
            
            modal.style.display = 'block';
        }
        
        // Sunburst Îç∞Ïù¥ÌÑ∞ Ï§ÄÎπÑ
        function prepareSunburstData(selectedTeam, selectedRole, selectedPosition) {
            const labels = [];
            const parents = [];
            const values = [];
            const colors = [];
            
            // ÏÉâÏÉÅ ÌåîÎ†àÌä∏
            const colorPalette = [
                '#667eea', '#f56565', '#48bb78', '#ed8936', '#9f7aea',
                '#38b2ac', '#ed64a6', '#ecc94b', '#4299e1', '#a0aec0'
            ];
            
            // ÌïÑÌÑ∞ÎßÅÎêú Îç∞Ïù¥ÌÑ∞
            let filteredData = hierarchyData;
            if (selectedTeam) {
                filteredData = filteredData.filter(d => d.teams === selectedTeam);
            }
            if (selectedRole) {
                filteredData = filteredData.filter(d => d.role_categories === selectedRole);
            }
            if (selectedPosition) {
                filteredData = filteredData.filter(d => d.position_1st === selectedPosition);
            }
            
            // Î£®Ìä∏ ÎÖ∏Îìú
            labels.push(selectedPosition || selectedRole || selectedTeam || 'Ï†ÑÏ≤¥');
            parents.push('');
            values.push(filteredData.length);
            colors.push('#e0e0e0');
            
            // Í≥ÑÏ∏µÎ≥Ñ Îç∞Ïù¥ÌÑ∞ Ï∂îÍ∞Ä
            const processed = new Set();
            
            filteredData.forEach((item, index) => {
                // Teams Î†àÎ≤® (ÏÑ†ÌÉùÎêòÏßÄ ÏïäÏùÄ Í≤ΩÏö∞Îßå)
                if (!selectedTeam && item.teams) {
                    const key = item.teams;
                    if (!processed.has(key)) {
                        labels.push(item.teams);
                        parents.push(labels[0]);
                        values.push(filteredData.filter(d => d.teams === item.teams).length);
                        colors.push(colorPalette[processed.size % colorPalette.length]);
                        processed.add(key);
                    }
                }
                
                // Role Categories Î†àÎ≤®
                if (!selectedRole && item.role_categories) {
                    const parentKey = selectedTeam || item.teams;
                    const key = `${parentKey}|${item.role_categories}`;
                    if (!processed.has(key)) {
                        labels.push(item.role_categories);
                        parents.push(parentKey);
                        values.push(filteredData.filter(d => 
                            d.teams === item.teams && 
                            d.role_categories === item.role_categories
                        ).length);
                        colors.push(colorPalette[labels.length % colorPalette.length]);
                        processed.add(key);
                    }
                }
                
                // Position 1st Î†àÎ≤®
                if (!selectedPosition && item.position_1st) {
                    const parentKey = selectedRole || item.role_categories || 'NONE';
                    const key = `${parentKey}|${item.position_1st}`;
                    if (!processed.has(key)) {
                        labels.push(item.position_1st);
                        parents.push(parentKey);
                        values.push(filteredData.filter(d => 
                            d.teams === item.teams && 
                            d.role_categories === item.role_categories &&
                            d.position_1st === item.position_1st
                        ).length);
                        colors.push(colorPalette[labels.length % colorPalette.length]);
                        processed.add(key);
                    }
                }
                
                // Position 2nd Î†àÎ≤®
                if (item.position_2nd) {
                    const parentKey = item.position_1st;
                    const key = `${parentKey}|${item.position_2nd}`;
                    if (!processed.has(key)) {
                        labels.push(item.position_2nd);
                        parents.push(parentKey);
                        values.push(1);
                        colors.push(colorPalette[labels.length % colorPalette.length]);
                        processed.add(key);
                    }
                }
                
                // Position 3rd Î†àÎ≤®
                if (item.position_3rd) {
                    const parentKey = item.position_2nd;
                    const key = `${parentKey}|${item.position_3rd}`;
                    if (!processed.has(key)) {
                        labels.push(item.position_3rd);
                        parents.push(parentKey);
                        values.push(1);
                        colors.push(colorPalette[labels.length % colorPalette.length]);
                        processed.add(key);
                    }
                }
            });
            
            return { labels, parents, values, colors };
        }
        
        // Î≤îÎ°Ä ÏÉùÏÑ±
        function createLegend() {
            const legendContainer = document.getElementById('treemap-legend');
            const legendItems = [
                { color: '#00C851', label: '15% Ïù¥ÏÉÅ Ï¶ùÍ∞Ä' },
                { color: '#2ECC71', label: '10-15% Ï¶ùÍ∞Ä' },
                { color: '#5CB85C', label: '5-10% Ï¶ùÍ∞Ä' },
                { color: '#7FB069', label: '2-5% Ï¶ùÍ∞Ä' },
                { color: '#90C695', label: '0-2% Ï¶ùÍ∞Ä' },
                { color: '#757575', label: 'Î≥ÄÌôî ÏóÜÏùå' },
                { color: '#EF9A9A', label: '0-2% Í∞êÏÜå' },
                { color: '#E57373', label: '2-5% Í∞êÏÜå' },
                { color: '#D9534F', label: '5-10% Í∞êÏÜå' },
                { color: '#E74C3C', label: '10-15% Í∞êÏÜå' },
                { color: '#CC0000', label: '15% Ïù¥ÏÉÅ Í∞êÏÜå' }
            ];
            
            legendItems.forEach(item => {
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                legendItem.innerHTML = `
                    <div class="legend-color" style="background-color: ${item.color}"></div>
                    <span>${item.label}</span>
                `;
                legendContainer.appendChild(legendItem);
            });
        }
        
        // ÌÜµÍ≥Ñ Ïπ¥Îìú ÏÉùÏÑ±
        function createStatsCards() {
            const statsGrid = document.getElementById('stats-grid');
            
            // Ï†ÑÏ≤¥ ÌÜµÍ≥Ñ Í≥ÑÏÇ∞
            const totalCurrent = Object.values(teamStats).reduce((sum, team) => sum + (team.current || 0), 0);
            const totalPrevious = Object.values(teamStats).reduce((sum, team) => sum + (team.previous || 0), 0);
            const totalChange = totalCurrent - totalPrevious;
            const totalChangePercent = totalPrevious > 0 ? (totalChange / totalPrevious) * 100 : 0;
            
            const stats = [
                {
                    label: 'Ï†ÑÏ≤¥ Ïù∏Ïõê',
                    value: totalCurrent,
                    change: totalChange,
                    changePercent: totalChangePercent
                },
                {
                    label: 'ÌåÄ Ïàò',
                    value: Object.keys(teamStats).length,
                    change: 0,
                    changePercent: 0
                },
                {
                    label: 'ÌèâÍ∑† ÌåÄ Ïù∏Ïõê',
                    value: Math.round(totalCurrent / Object.keys(teamStats).length),
                    change: 0,
                    changePercent: 0
                }
            ];
            
            stats.forEach(stat => {
                const card = document.createElement('div');
                card.className = 'stat-card';
                
                const changeClass = stat.change > 0 ? 'positive' : stat.change < 0 ? 'negative' : 'neutral';
                const changeText = stat.change !== 0 ? 
                    `<div class="stat-change ${changeClass}">
                        ${stat.change > 0 ? '+' : ''}${stat.change}Î™Ö (${stat.changePercent.toFixed(1)}%)
                    </div>` : '';
                
                card.innerHTML = `
                    <div class="stat-value">${stat.value}</div>
                    <div class="stat-label">${stat.label}</div>
                    ${changeText}
                `;
                
                statsGrid.appendChild(card);
            });
        }
        
        // Î™®Îã¨ Îã´Í∏∞ Ïù¥Î≤§Ìä∏
        document.querySelector('.close').onclick = function() {
            document.getElementById('sunburstModal').style.display = 'none';
        }
        
        window.onclick = function(event) {
            const modal = document.getElementById('sunburstModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïã§Ìñâ
        window.onload = function() {
            create3LevelTreemap();
            createLegend();
            createStatsCards();
        }
    </script>
</body>
</html>