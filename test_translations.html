<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Translation Test</title>
    <script>
        // Load the dashboard HTML and test translations
        function testTranslations() {
            fetch('output_files/dashboard_2025_08.html')
                .then(response => response.text())
                .then(html => {
                    // Create a parser
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    
                    // Extract the translation JSON from the script
                    const scripts = doc.querySelectorAll('script');
                    let translations = null;
                    
                    for (let script of scripts) {
                        if (script.textContent.includes('const translations =')) {
                            // Extract the translations object
                            const match = script.textContent.match(/const translations = ({[\s\S]*?});/);
                            if (match) {
                                try {
                                    translations = JSON.parse(match[1]);
                                    console.log('✅ Translations loaded successfully');
                                    
                                    // Test key translations
                                    const testKeys = [
                                        'modal.totalPersonnel',
                                        'modal.paidPersonnel',
                                        'modal.unpaidPersonnel',
                                        'modal.paymentRate',
                                        'modal.avgIncentive',
                                        'modal.all',
                                        'modal.paidOnly',
                                        'modal.unpaidOnly',
                                        'modal.tableHeaders.employeeNo',
                                        'modal.paymentStatus.paid',
                                        'modal.paymentStatus.unpaid',
                                        'modal.conditionCategories.attendance',
                                        'modal.conditionCategories.aql',
                                        'modal.conditionCategories.prs'
                                    ];
                                    
                                    let results = [];
                                    for (let key of testKeys) {
                                        const parts = key.split('.');
                                        let value = translations;
                                        let found = true;
                                        
                                        for (let part of parts) {
                                            if (value && value[part]) {
                                                value = value[part];
                                            } else {
                                                found = false;
                                                break;
                                            }
                                        }
                                        
                                        if (found && value.ko && value.en && value.vi) {
                                            results.push(`✅ ${key}: KO="${value.ko}" | EN="${value.en}" | VI="${value.vi}"`);
                                        } else {
                                            results.push(`❌ ${key}: Missing translation`);
                                        }
                                    }
                                    
                                    document.getElementById('results').innerHTML = '<pre>' + results.join('\n') + '</pre>';
                                } catch (e) {
                                    console.error('Failed to parse translations:', e);
                                }
                            }
                        }
                    }
                })
                .catch(error => {
                    document.getElementById('results').innerHTML = `<p style="color: red;">Error loading dashboard: ${error}</p>`;
                });
        }
    </script>
</head>
<body>
    <h1>Translation Keys Test</h1>
    <button onclick="testTranslations()">Test Translations</button>
    <div id="results"></div>
</body>
</html>